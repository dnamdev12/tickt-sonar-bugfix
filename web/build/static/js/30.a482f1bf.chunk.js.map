{"version":3,"sources":["assets/images/ic-cancel-blue.png","assets/images/menu-line-blue.png","assets/images/not-found.png","assets/images/video@3x.png","pages/chat/userMessages.tsx","assets/images/icon-direction-blue.png","assets/images/ic-media.png","assets/images/ic-send.png","pages/chat/chat.tsx","assets/images/search-chat.png","pages/chat/index.tsx"],"names":["lastDate","docTypes","UserMessages","props","divRref","useRef","useState","storageService","getItem","_id","userId","toggle","setToggle","jobDetailLoader","setJobDetailLoader","currentJobDetails","setCurrentJobDetails","messageText","setMessageText","messages","setMessages","isDocUploading","setIsDocUploading","itemsMedia","setItemsMedia","toggler","setToggler","selectedSlide","setSelectSlide","fsSlideListner","setFsSlideListner","useEffect","roomId","getMessagesOfRoom","onReceiveOfNewMsg","scrollToBottom","current","scroll","scrollHeight","clientHeight","scrollTo","arrmsg","fsSlideObj","mediaMsgs","slideCount","length","filter","item","index","messageType","setInboxToTopWithLastMsg","lastMsg","newInboxData","inBoxData","currentIndex","findIndex","i","splice","unshift","setInBoxData","sendMessage","a","trimLeft","sendTextMessage","roomData","oppUserInfo","deviceToken","deviceType","hasOwnProperty","isNotification","sendFCMPushNotificationToOppUser","mData","timeStamp","moengage","getCurrentTimeStamp","moE_SendEvent","MoEConstants","CHAT","mixPanel","mixP_SendEvent","sendImageVideoMsg","url","msgType","sendImageVideoMessage","fetchJobDetail","jobId","getJobDetails","res","success","jobInfo","jobDescription","data","details","jobName","amount","locationName","fromDate","toDate","duration","status","setResDeviceType","msg","Number","app_icon","title","notificationText","userName","senderName","room_id","messageRoomId","image","user_image","notificationType","sound","body","sender","first_name","device_token","user_id","device_type","split","badge","notification_type","messageId","notification","newData","to","headers_","Authorization","Constants","FcmHeaderAuthorizationKey","fetch","method","headers","JSON","stringify","console","log","handleUpload","e","maxFileSize","formData","FormData","newFile","target","files","fileType","type","toLowerCase","selectedFileSize","size","includes","indexOf","setShowToast","append","check_type","onFileUpload","imgUrl","displayMessages","curDate","formatDateTime","messageTimestamp","messageClass","senderId","className","renderTextMsg","src","mediaUrl","notFound","alt","decoding","loading","onError","onerror","onClick","prev","renderImageMsg","poster","chatVideoIcon","renderVideoMsg","sources","types","forEach","push","renderMediaItems","isNoRecords","slide","onClose","dummy","history","name","ref","map","isBlock","style","color","htmlFor","id","accept","onChange","disabled","placeholder","onKeyDown","event","shiftKey","key","preventDefault","value","loader","width","close","renderTime","urlEncode","selectedRoomID","isFreshChatRoute","Chat","initializing","setInitializing","auth","currentUser","setUser","filterInBoxData","setFilterInBoxData","setIsNoRecords","setRoomData","setRoomId","searchQuery","setSearchQuery","searchActive","setSearchActive","isInitialLoader","setIsInitialLoader","isMobInbox","setIsMobInbox","location","state","tradieId","builderId","setLoading","setInitialItems","getFirebaseInboxData","onUpdateofInbox","stopListeningOfRoom","roomID","checkRoomExist","createRoom","selectedRoomInfo","sortedRes","sort","x","y","ress","newRes","Array","isArray","firstKey","unreadMessages","resetUnreadCounter","itemObj","find","unsubscribe","onAuthStateChanged","user","getRoomDetails","filteredVal","menu","marginLeft","href","isLoading","noData","ChatComponent","connect","common","isSkeletonLoading","dispatch","bindActionCreators"],"mappings":"+GAAe,snB,iCCAA,sO,iCCAA,QAA0B,uC,qMCA1B,uzB,yDCgCXA,EAAW,GACTC,EAAuB,CAAC,OAAQ,MAAO,MAAO,MAAO,MAAO,OA+oBnDC,EA7oBM,SAACC,GAAgB,IAAD,kBAC7BC,EAAUC,iBAAuB,MACvC,EAAiBC,mBAAQ,UAASC,IAAeC,QAAQ,mBAAhC,aAAS,EAAoCC,KAA/DC,EAAP,oBACA,EAA4BJ,oBAAkB,GAA9C,mBAAOK,EAAP,KAAeC,EAAf,KACA,EAA8CN,oBAAkB,GAAhE,mBAAOO,EAAP,KAAwBC,EAAxB,KACA,EAAkDR,mBAAc,MAAhE,mBAAOS,EAAP,KAA0BC,EAA1B,KACA,EAAsCV,mBAAc,IAApD,mBAAOW,EAAP,KAAoBC,EAApB,KACA,EAAgCZ,mBAAqB,IAArD,mBAAOa,GAAP,KAAiBC,GAAjB,KACA,GAA4Cd,oBAAkB,GAA9D,qBAAOe,GAAP,MAAuBC,GAAvB,MAEA,GAAoChB,mBAAS,IAA7C,qBAAOiB,GAAP,MAAmBC,GAAnB,MACA,GAA8BlB,oBAAS,GAAvC,qBAAOmB,GAAP,MAAgBC,GAAhB,MACA,GAAwCpB,mBAAc,GAAtD,qBAAOqB,GAAP,MAAsBC,GAAtB,MACA,GAA4CtB,mBAAc,IAA1D,qBAAOuB,GAAP,MAAuBC,GAAvB,MACA,GAA8CxB,mBAAc,IAA5D,iCAEAyB,qBAAU,WACa,KAAjB5B,EAAM6B,SACRhC,EAAW,GACXiC,YAAkB9B,EAAM6B,OAAQE,IAChCN,GAAe,GACfE,GAAkB,IAClBN,GAAc,IACdR,EAAqB,MACrBJ,GAAU,MAEX,CAACT,EAAM6B,SAIVD,qBAAU,WACRI,QAGF,IAAMA,GAAiB,WACrB,GAAI,eAAS/B,QAAT,IAASA,OAAT,EAASA,EAASgC,SAAS,CAC7B,IAAMC,EACJjC,EAAQgC,QAAQE,aAAelC,EAAQgC,QAAQG,aAEjDnC,EAAQgC,QAAQI,SAAS,EAAGH,KAI1BH,GAAoB,SAACO,GAEzBrB,GAAYqB,IAGdV,qBAAU,WACR,IAAIW,EAAkB,GAClBC,EAAiB,GACjBC,EAAa,EACbzB,GAAS0B,SACXF,EAAYxB,GAAS2B,QAAO,SAACC,EAAWC,GACtC,GAAyB,UAArBD,EAAKE,aAAgD,UAArBF,EAAKE,YAEvC,OADAP,EAAW,GAAD,OAAIM,IAAWJ,IAClBG,KAGXvB,GAAcmB,GACdb,GAAkBY,MAEnB,CAACvB,KAGJ,IAAM+B,GAA2B,SAACC,GAChC,IAAMC,EAAY,YAAOjD,EAAMkD,WACzBC,EAAeF,EAAaG,WAChC,SAACC,GAAD,OAAOA,EAAExB,SAAW7B,EAAM6B,UAE5BoB,EAAaE,GAAcH,QAAUA,EACrCC,EAAaK,OAAOH,EAAc,GAClCF,EAAaM,QAAQvD,EAAMkD,UAAUC,IACrCnD,EAAMwD,aAAaP,IAMfQ,GAAW,uCAAG,8CAAAC,EAAA,0DAEd5C,GAA0C,KAA3BA,EAAY6C,WAFb,uBAGhB5C,EAAe,IAHC,SAIW6C,YAAgB5D,EAAM6B,OAAQf,GAJzC,QAIVkC,EAJU,UAMP,UACPhD,EAAM6D,gBADC,iBACP,EAAgBC,mBADT,aACP,EAA6BC,eAD7B,UAEA/D,EAAM6D,gBAFN,iBAEA,EAAgBC,mBAFhB,aAEA,EAA6BE,gBAC5B,UAAAhE,EAAM6D,gBAAN,mBAAgBC,mBAAhB,eAA6BG,eAAe,qBAA5C,UACGjE,EAAM6D,gBADT,iBACG,EAAgBC,mBADnB,aACG,EAA6BI,mBAGjCC,GAAiCnB,GAC3BoB,EAAQ,CACZC,UAAWC,IAASC,uBAEtBD,IAASE,cAAcC,IAAaC,KAAMN,GAC1CO,IAASC,eAAeH,IAAaC,KAAMN,IAE7CrB,GAAyBC,GApBT,2CAAH,qDAgCX6B,GAAiB,uCAAG,WAAOC,EAAaC,GAApB,+BAAArB,EAAA,0DAEpBoB,GAAe,KAARA,EAFa,gCAGKE,YACzBhF,EAAM6B,OACNiD,EACAC,GANoB,QAGhB/B,EAHgB,UASb,UACPhD,EAAM6D,gBADC,iBACP,EAAgBC,mBADT,aACP,EAA6BC,eAD7B,UAEA/D,EAAM6D,gBAFN,iBAEA,EAAgBC,mBAFhB,aAEA,EAA6BE,gBAC5B,UAAAhE,EAAM6D,gBAAN,mBAAgBC,mBAAhB,eAA6BG,eAAe,qBAA5C,UACGjE,EAAM6D,gBADT,iBACG,EAAgBC,mBADnB,aACG,EAA6BI,kBAGjCC,GAAiCnB,GAEnCD,GAAyBC,GAlBH,OAoBxBjC,EAAe,IApBS,2CAAH,wDAuBjBkE,GAAc,uCAAG,WAAOC,GAAP,mCAAAxB,EAAA,6DACrB/C,GAAmB,GADE,SAEHwE,YAAcD,GAFX,QAEfE,EAFe,QAGbC,UACAC,EAAU,CACdC,gBAAgB,UAAAH,EAAII,YAAJ,eAAUC,UAAW,GACrCP,OAAO,UAAAE,EAAII,YAAJ,eAAUN,QAAS,GAC1BQ,SAAS,UAAAN,EAAII,YAAJ,eAAUE,UAAW,GAC9BC,QAAQ,UAAAP,EAAII,YAAJ,eAAUG,SAAU,GAC5BC,cAAc,UAAAR,EAAII,YAAJ,eAAUI,eAAgB,GACxCC,UAAU,UAAAT,EAAII,YAAJ,eAAUK,WAAY,GAChCC,QAAQ,UAAAV,EAAII,YAAJ,eAAUM,SAAU,GAC5BC,UAAU,UAAAX,EAAII,YAAJ,eAAUO,WAAY,GAChCC,QAAQ,UAAAZ,EAAII,YAAJ,eAAUQ,SAAU,IAE9BnF,EAAqByE,GACrB3E,GAAmB,IAhBA,2CAAH,sDAwCdsF,GAAmB,SAACjC,EAAoBkC,GAAc,IAAD,gCACzD,OAAQC,OAAOnC,IACb,KAAK,EACH,MAAO,CACLoC,SACE,mFACFC,MAAO,YACPC,iBAAiB,GAAD,iBACdlG,IAAeC,QAAQ,mBADT,aACd,EAAoCkG,SADtB,uBAGhBC,WAAW,GAAD,iBAAKpG,IAAeC,QAAQ,mBAA5B,aAAK,EAAoCkG,UACnDzD,YAAY,GAAD,cAAKoD,QAAL,IAAKA,OAAL,EAAKA,EAAKpD,aACrBhC,YAAY,GAAD,OAA0B,UAAlB,OAAHoF,QAAG,IAAHA,OAAA,EAAAA,EAAKpD,aAAL,OAA8BoD,QAA9B,IAA8BA,OAA9B,EAA8BA,EAAKpF,YAAc,IACjE2F,QAAO,OAAEP,QAAF,IAAEA,OAAF,EAAEA,EAAKQ,cACdC,MAAK,UAAEvG,IAAeC,QAAQ,mBAAzB,aAAE,EAAoCuG,WAC3CC,iBAAkB,GAClBC,MAAO,WAEX,KAAK,EACH,MAAO,CACLC,KAAI,OAAEb,QAAF,IAAEA,OAAF,EAAEA,EAAKpF,YACXA,YAAW,OAAEoF,QAAF,IAAEA,OAAF,EAAEA,EAAKpF,YAClBkG,OAAQ,CACNC,WAAU,UAAE7G,IAAeC,QAAQ,mBAAzB,aAAE,EAAoCkG,SAChDW,aAAc9G,IAAeC,QAAQ,YACrC8G,QAAO,UAAE/G,IAAeC,QAAQ,mBAAzB,aAAE,EAAoCC,IAC7C8G,YAAa,GAEflC,MAAK,OAAEgB,QAAF,IAAEA,GAAF,UAAEA,EAAKQ,qBAAP,iBAAE,EAAoBW,MAAM,YAA5B,aAAE,EAAiC,GACxCC,MAAO,EACPF,YAAa,EACbf,MAAK,UAAEjG,IAAeC,QAAQ,mBAAzB,aAAE,EAAoCkG,SAC3Cb,QAAO,UAAE1F,EAAM6D,gBAAR,aAAE,EAAgB6B,QACzB6B,kBAAmB,GACnBT,MAAO,UACPU,UAAS,OAAEtB,QAAF,IAAEA,OAAF,EAAEA,EAAKsB,WAEpB,KAAK,EACH,MAAO,CACLC,aAAc,CACZV,KAAI,OAAEb,QAAF,IAAEA,OAAF,EAAEA,EAAKpF,YACXuF,MAAK,UAAEjG,IAAeC,QAAQ,mBAAzB,aAAE,EAAoCkG,UAE7Cf,KAAM,CACJuB,KAAI,OAAEb,QAAF,IAAEA,OAAF,EAAEA,EAAKpF,YACXA,YAAW,OAAEoF,QAAF,IAAEA,OAAF,EAAEA,EAAKpF,YAClBkG,OAAQ,CACNC,WAAU,UAAE7G,IAAeC,QAAQ,mBAAzB,aAAE,EAAoCkG,SAChDW,aAAc9G,IAAeC,QAAQ,YACrC8G,QAAO,UAAE/G,IAAeC,QAAQ,mBAAzB,aAAE,EAAoCC,IAC7C8G,YAAa,GAEflC,MAAK,OAAEgB,QAAF,IAAEA,GAAF,UAAEA,EAAKQ,qBAAP,iBAAE,EAAoBW,MAAM,YAA5B,aAAE,EAAiC,GACxCC,MAAO,EACPF,YAAa,EACbf,MAAK,UAAEjG,IAAeC,QAAQ,mBAAzB,aAAE,EAAoCkG,SAC3Cb,QAAO,UAAE1F,EAAM6D,gBAAR,aAAE,EAAgB6B,QACzB6B,kBAAmB,GACnBT,MAAO,UACPU,UAAS,OAAEtB,QAAF,IAAEA,OAAF,EAAEA,EAAKsB,YAGtB,QACE,SAGArD,GAAgC,uCAAG,WAAO+B,GAAP,uCAAAxC,EAAA,6DACnC8B,EAAOS,GAAgB,UAACjG,EAAM6D,gBAAP,iBAAC,EAAgBC,mBAAjB,aAAC,EAA6BE,WAAYkC,GACjEwB,EAFmC,qCAGrCC,GAAG,GAAD,iBAAK3H,EAAM6D,gBAAX,iBAAK,EAAgBC,mBAArB,aAAK,EAA6BC,cACW,IAA3C,UAAA/D,EAAM6D,gBAAN,mBAAgBC,mBAAhB,eAA6BE,aAAmB,CAAEwB,KAAMA,IACb,IAA3C,UAAAxF,EAAM6D,gBAAN,mBAAgBC,mBAAhB,eAA6BE,aAAmB,CAClDyD,aAAcjC,IAE+B,IAA3C,UAAAxF,EAAM6D,gBAAN,mBAAgBC,mBAAhB,eAA6BE,aAAmB,CAClDyD,aAAY,OAAEjC,QAAF,IAAEA,OAAF,EAAEA,EAAMiC,aACpBjC,KAAI,OAAEA,QAAF,IAAEA,OAAF,EAAEA,EAAMA,OAIVoC,EAAkB,CACtB,eAAgB,mBAChBC,cAAeC,IAAUC,2BAhBY,SAkBXC,MAAM,sCAAuC,CACvEC,OAAQ,OACRC,QAASN,EACTb,KAAMoB,KAAKC,UAAUV,KArBgB,OAwBf,MAxBe,OAwB1B1B,OACXqC,QAAQC,IAAI,yDAEZD,QAAQC,IAAI,yDA3ByB,2CAAH,sDA+BhCC,GAAY,uCAAG,WAAOC,GAAP,+BAAA9E,EAAA,yDACf+E,EAAsB,GACpBC,EAAW,IAAIC,SACfC,EAAUJ,EAAEK,OAAOC,MAAM,GAC3BC,EAJe,OAIJH,QAJI,IAIJA,GAJI,UAIJA,EAASI,YAJL,iBAIJ,EAAe3B,MAAM,KAAK,UAJtB,aAIJ,EAA8B4B,cAEzCC,GAA0B,OAAPN,QAAO,IAAPA,OAAA,EAAAA,EAASO,MAAO,KAAO,KAC1C,CAAC,MAAO,MAAO,OAAOC,SAASL,KACjCN,EAAc,MAEZ3I,EAASuJ,QAAQN,GAAY,GAAKG,EAAmBT,GAVtC,uBAWjBa,aAAa,EAAM,6CAXF,iCAenBZ,EAASa,OAAO,OAAQX,GACxBzH,IAAkB,GACdqI,EAAkB,CAAC,OAAQ,MAAO,OAAOJ,SAASL,GAClD,EACA,CAAC,MAAO,MAAO,OAAOK,SAASL,GAC/B,EACA,KArBe,UAsBDU,YAAaf,GAtBZ,SAsBbtD,EAtBa,QAuBXC,SAAWD,EAAIsE,SACF,IAAfF,EACF3E,GAAkBO,EAAIsE,OAAQ,SACN,IAAfF,EACT3E,GAAkBO,EAAIsE,OAAQ,SAE9BJ,aAAa,EAAM,iCAErBnI,IAAkB,IA/BD,4CAAH,sDA4LZwI,GAAkB,SAACzD,EAAUrD,GAEjC,OADc,IAAVA,IAAahD,EAAW,IACpBqG,EAAIpD,aACV,IAAK,OACH,OA5JgB,SAACoD,GACrB,IAAI0D,EAAUC,YAAe3D,EAAI4D,iBAAkB,OAC7CC,EACJ7D,EAAI8D,WAAazJ,EAAS,UAAY,qBACxC,MAAiB,KAAbV,GAAmBA,IAAa+J,GAClC/J,EAAW+J,EAET,qCACE,qBAAKK,UAAU,YAAf,SACE,+BAAOL,MAET,qBAAKK,UAAS,UAAKF,GAAnB,SACE,oBAAGE,UAAS,UAAK/D,EAAI8D,WAAazJ,EAAS,OAAS,IAApD,UACG2F,EAAIpF,YACL,sBAAMmJ,UAAU,OAAhB,SACGJ,YAAe3D,EAAI4D,iBAAkB,mBAQ9C,qBAAKG,UAAS,UAAKF,GAAnB,SACE,oBAAGE,UAAS,UAAK/D,EAAI8D,WAAazJ,EAAS,OAAS,IAApD,UACG2F,EAAIpF,YACL,sBAAMmJ,UAAU,OAAhB,SACGJ,YAAe3D,EAAI4D,iBAAkB,eAiIrCI,CAAchE,GACvB,IAAK,QACH,OA5HiB,SAACA,EAAUrD,GAChC,IAAI+G,EAAUC,YAAe3D,EAAI4D,iBAAkB,OAC7CC,EACJ7D,EAAI8D,WAAazJ,EAAS,UAAY,qBACxC,MAAiB,KAAbV,GAAmBA,IAAa+J,GAClC/J,EAAW+J,EAET,qCACE,qBAAKK,UAAU,YAAf,SACE,+BAAOL,MAET,qBAAKK,UAAS,UAAKF,GAAnB,SACE,yBAAQE,UAAU,QAAlB,UACE,qBACEE,IAAKjE,EAAIkE,UAAYC,IACrBC,IAAI,QACJ,YAAWpE,EAAIkE,UAAYC,IAC3BE,SAAS,QACTC,QAAQ,OACRC,QAAS,SAACjC,GAAY,IAAD,KACnB,OAAIA,QAAJ,IAAIA,GAAJ,UAAIA,EAAGK,cAAP,aAAI,EAAW6B,WACblC,EAAEK,OAAO6B,QAAU,OAErB,OAAIlC,QAAJ,IAAIA,GAAJ,UAAIA,EAAGK,cAAP,aAAI,EAAWsB,OACb3B,EAAEK,OAAOsB,IAAME,MAGnBM,QAAS,WACPpJ,IAAW,SAACqJ,GAAD,OAAgBA,KAC3BnJ,GAAeC,GAAe,GAAD,OAAImB,QAGrC,sBAAMoH,UAAU,OAAhB,SACGJ,YAAe3D,EAAI4D,iBAAkB,mBAQ9C,qBAAKG,UAAS,UAAKF,GAAnB,SACE,yBAAQE,UAAU,QAAlB,UACE,qBACEE,IAAKjE,EAAIkE,UAAYC,IACrBC,IAAI,QACJ,YAAWpE,EAAIkE,UAAYC,IAC3BE,SAAS,QACTC,QAAQ,OACRC,QAAS,SAACjC,GAAY,IAAD,KACnB,OAAIA,QAAJ,IAAIA,GAAJ,UAAIA,EAAGK,cAAP,aAAI,EAAW6B,WACblC,EAAEK,OAAO6B,QAAU,OAErB,OAAIlC,QAAJ,IAAIA,GAAJ,UAAIA,EAAGK,cAAP,aAAI,EAAWsB,OACb3B,EAAEK,OAAOsB,IAAME,MAGnBM,QAAS,WACPpJ,IAAW,SAACqJ,GAAD,OAAgBA,KAC3BnJ,GAAeC,GAAe,GAAD,OAAImB,QAGrC,sBAAMoH,UAAU,OAAhB,SACGJ,YAAe3D,EAAI4D,iBAAkB,eA6DrCe,CAAe3E,EAAKrD,GAC7B,IAAK,QACH,OAxDiB,SAACqD,EAAUrD,GAChC,IAAI+G,EAAUC,YAAe3D,EAAI4D,iBAAkB,OAC7CC,EACJ7D,EAAI8D,WAAazJ,EAAS,UAAY,qBACxC,MAAiB,KAAbV,GAAmBA,IAAa+J,GAClC/J,EAAW+J,EAET,qCACE,qBAAKK,UAAU,YAAf,SACE,+BAAOL,MAET,qBAAKK,UAAS,UAAKF,GAAnB,SACE,yBAAQE,UAAU,qBAAlB,UACE,uBACEE,IAAKjE,EAAIkE,UAAYC,IACrBS,OAAQC,EACRJ,QAAS,WACPpJ,IAAW,SAACqJ,GAAD,OAAgBA,KAC3BnJ,GAAeC,GAAe,GAAD,OAAImB,QAGrC,sBAAMoH,UAAU,OAAhB,SACGJ,YAAe3D,EAAI4D,iBAAkB,mBAQ9C,qBAAKG,UAAS,UAAKF,GAAnB,SACE,yBAAQE,UAAU,qBAAlB,UACE,uBACEE,IAAKjE,EAAIkE,UAAYC,IACrBS,OAAQC,EACRJ,QAAS,WACPpJ,IAAW,SAACqJ,GAAD,OAAgBA,KAC3BnJ,GAAeC,GAAe,GAAD,OAAImB,QAGrC,sBAAMoH,UAAU,OAAhB,SACGJ,YAAe3D,EAAI4D,iBAAkB,eAerCkB,CAAe9E,EAAKrD,KAIjC,GA7TyB,SAACzB,GACxB,IAAI6J,EAAe,GACfC,EAAa,GAejB,OAbI9J,EAAWsB,QACbtB,EAAW+J,SAAQ,SAACvI,GACO,UAArBA,EAAKE,cACPmI,EAAQG,KAAKxI,EAAKwH,UAClBc,EAAME,KAAK,UAEY,UAArBxI,EAAKE,cACPmI,EAAQG,KAAKxI,EAAKwH,UAClBc,EAAME,KAAK,aAKV,CAAEH,UAASC,SA4SOG,CAAiBjK,IAApC6J,GAAR,GAAQA,QAASC,GAAjB,GAAiBA,MAEjB,OAAOlL,EAAMsL,YACX,qBAAKrB,UAAU,aAAf,SACE,qBAAKA,UAAU,WAAf,SAEE,4BAIJ,qCACE,cAAC,IAAD,CACE3I,QAASA,GACTiK,MAAO/J,GACPyJ,QAASA,GACTC,MAAOA,GAGPM,QAAS,WACP/J,GAAe,KARnB,OAKOwJ,SALP,IAKOA,QALP,EAKOA,GAASvI,QAMhB,qBAAKuH,UAAU,aAAf,SACE,sBAAKA,UAAU,WAAf,UACE,sBAAKA,UAAS,mBAAczJ,EAAS,SAAW,IAAhD,UACE,sBAAKyJ,UAAU,YAAf,UACE,wBAAQA,UAAU,QAAlB,SACE,qBACEE,KAAK,UAAAnK,EAAM6D,gBAAN,mBAAgBC,mBAAhB,eAA6B6C,QAAS8E,IAC3CnB,IAAI,WACJG,QAAS,SAACjC,GAAY,IAAD,KACnB,OAAIA,QAAJ,IAAIA,GAAJ,UAAIA,EAAGK,cAAP,aAAI,EAAW6B,WACblC,EAAEK,OAAO6B,QAAU,OAErB,OAAIlC,QAAJ,IAAIA,GAAJ,UAAIA,EAAGK,cAAP,aAAI,EAAWsB,OACb3B,EAAEK,OAAOsB,IAAMsB,UAKvB,sBACExB,UAAU,OACVU,QAAS,WACwC,IAAD,IAIvC,IAJoC,IAAvCvK,IAAeC,QAAQ,YACzBL,EAAM0L,QAAQN,KAAd,yCAC0BpL,EAAM6D,gBADhC,iBAC0B,EAAgBC,mBAD1C,aAC0B,EAA6BvD,OADvD,qBAIAP,EAAM0L,QAAQN,KAAd,4CAC6BpL,EAAM6D,gBADnC,iBAC6B,EAAgBC,mBAD7C,aAC6B,EAA6BvD,UAThE,mBAcGP,EAAM6D,gBAdT,iBAcG,EAAgBC,mBAdnB,aAcG,EAA6B6H,QAE9BnL,GACA,uBACEmK,QAAS,WAAO,IAAD,EACblK,GAAU,GACNG,GACJqE,GAAc,UAACjF,EAAM6D,gBAAP,aAAC,EAAgBqB,QAEjC+E,UAAU,cANZ,6BASE,qBAAKE,IC5jBR,iXD4jBuBG,IAAI,oBAI9B,sBAAKL,UAAU,gBAAgB2B,IAAK3L,EAApC,UACGe,GAAS0B,OAAS,GACjB1B,GAAS6K,KAAI,SAAC3F,EAAUrD,GACtB,OAAO8G,GAAgBzD,EAAKrD,MAEhC,qBAAKoH,UAAU,YAAf,UACG,UAAAjK,EAAM6D,gBAAN,mBAAgBC,mBAAhB,eAA6BgI,UAC5B,mBAAGC,MAAO,CAAEC,MAAO,WAAnB,SACG,gDAMR,UAAChM,EAAM6D,gBAAP,iBAAC,EAAgBC,mBAAjB,aAAC,EAA6BgI,UAC7B,qBAAK7B,UAAU,WAAf,SACE,sBAAKA,UAAU,aAAf,UACE,uBAAOA,UAAU,cAAcgC,QAAQ,cAAvC,SACE,sBAAMhC,UAAU,kBAAhB,SACE,qBAAKE,IEnlBZ,qtBFmlB4BG,IAAI,cAG7B,uBACE4B,GAAG,cACHjC,UAAU,OACVjB,KAAK,OACLmD,OAAO,kEACPC,SAAU7D,GACV8D,SAAUnL,KAEZ,0BACEoL,YAAY,YACZC,UAtdI,SAACC,GAChBA,EAAMC,UAA0B,UAAdD,EAAME,MAC3BF,EAAMG,iBACNlJ,KACA1C,EAAe,MAmdD6L,MAAO9L,EACPsL,SAAU,SAAC5D,GAAD,OAAOzH,EAAeyH,EAAEK,OAAO+D,UAE3C,sBAAM3C,UAAU,cAAhB,SACE,qBAAKE,IGrmBV,idHqmBwBG,IAAI,OAAOK,QAASlH,eAOhDjD,GAAUE,EACT,qBAAKuJ,UAAU,kBAAf,SACE,qBAAKA,UAAU,YAAf,SACE,iCACE,qBAAKE,IAAK0C,IAAQvC,IAAI,SAASwC,MAAM,gBAIzCtM,EACF,sBAAKyJ,UAAU,kBAAf,UACE,sBAAKA,UAAU,qBAAf,UACE,sBAAMA,UAAU,qBAAhB,gBACGrJ,QADH,IACGA,OADH,EACGA,EAAmB8E,UAEtB,sBACEiF,QAAS,WACPlK,GAAU,SAACmK,GAAD,OAAWA,MAEvBX,UAAU,QAJZ,SAME,qBAAKE,IAAK4C,IAAOzC,IAAI,eAIzB,qBAAKL,UAAU,WAAf,SACE,+BACE,oBAAIA,UAAU,aAAd,SACG+C,YAAU,OACTpM,QADS,IACTA,OADS,EACTA,EAAmBiF,SADV,OAETjF,QAFS,IAETA,OAFS,EAETA,EAAmBkF,UAGvB,oBAAImE,UAAU,cAAd,gBAA6BrJ,QAA7B,IAA6BA,OAA7B,EAA6BA,EAAmB+E,SAChD,oBAAIsE,UAAU,uBAAd,gBACGrJ,QADH,IACGA,OADH,EACGA,EAAmBgF,eAEtB,oBAAIqE,UAAU,gBAAd,gBACGrJ,QADH,IACGA,OADH,EACGA,EAAmBmF,gBAK1B,mBAAGkE,UAAU,aAAb,gBAA2BrJ,QAA3B,IAA2BA,OAA3B,EAA2BA,EAAmB2E,iBAE9C,wBACE0E,UAAU,+BACVU,QAAS,WACP,GAA2C,IAAvCvK,IAAeC,QAAQ,YACzBL,EAAM0L,QAAQN,KAAd,yCAC6BxK,QAD7B,IAC6BA,OAD7B,EAC6BA,EAAmBsE,MADhD,4BAGK,CAEL,IAAI+H,EAAc,wBAAarM,QAAb,IAAaA,OAAb,EAAaA,EAAmBsE,MAAhC,0BAAgDtE,QAAhD,IAAgDA,OAAhD,EAAgDA,EAAmBoF,OAAnE,gCAClBhG,EAAM0L,QAAQN,KAAd,sBAAkC6B,MAVxC,iCAiBA,cI3oBVC,EAAiB,GACjBC,GAA4B,EA+YjBC,EA7YF,SAACpN,GAAsB,IAAD,QACjC,EAAwCG,oBAAkB,GAA1D,mBAAOkN,EAAP,KAAqBC,EAArB,KAEA,EAAwBnN,oBAAc,kBAAMoN,IAAKC,eAAjD,mBAAaC,GAAb,WACA,EAAkCtN,mBAAc,IAAhD,mBAAO+C,EAAP,KAAkBM,EAAlB,KACA,EAA8CrD,mBAAc,IAA5D,mBAAOuN,EAAP,KAAwBC,EAAxB,KACA,EAAsCxN,oBAAkB,GAAxD,mBAAOmL,EAAP,KAAoBsC,EAApB,KACA,EAAgCzN,mBAAc,IAA9C,mBAAO0D,EAAP,KAAiBgK,EAAjB,KACA,EAA4B1N,mBAAiB,IAA7C,mBAAe2N,GAAf,WACA,EAAsC3N,mBAAS,IAA/C,mBAAO4N,EAAP,KAAoBC,EAApB,KACA,EAAwC7N,oBAAS,GAAjD,mBAAO8N,EAAP,KAAqBC,GAArB,KACA,GAA8C/N,oBAAS,GAAvD,qBAAOgO,GAAP,MAAwBC,GAAxB,MACA,GAAoCjO,oBAAkB,GAAtD,qBAAOkO,GAAP,MAAmBC,GAAnB,MAEA,IAAgD,UAAAtO,EAAM0L,eAAN,mBAAe6C,gBAAf,eAAyBC,OAAzB,UAC5CxO,EAAM0L,eADsC,iBAC5C,EAAe6C,gBAD6B,aAC5C,EAAyBC,MACzB,CAAEC,SAAU,GAAIC,UAAW,GAAIhJ,QAAS,GAAIR,MAAO,IAF/CuJ,GAAR,GAAQA,SAAUC,GAAlB,GAAkBA,UAAWhJ,GAA7B,GAA6BA,QAASR,GAAtC,GAAsCA,MAKtCtD,qBAAU,WAaR,OAXA,sBAAC,sBAAA8B,EAAA,yDACCiL,aAAW,KACPF,IAAYC,IAAahJ,IAAWR,IAFzC,gCAGS0J,KAHT,6BAKGzB,GAAmB,EALtB,uBAOO0B,YAAqBC,IAP5B,0CAAD,GAWO,WAELC,YAAoB7B,GACpBA,EAAiB,MAElB,IAEH,IAAM0B,GAAe,uCAAG,4BAAAlL,EAAA,6DAChBsL,EADgB,UACI9J,GADJ,YACauJ,GADb,YACyBC,IAC/CxB,EAAiB8B,EAFK,SAGZC,YAAeD,GAHH,oFAOdE,YAAWhK,GAAOuJ,GAAUC,GAAWhJ,IAPzB,4CAAH,qDAYfoJ,GAAe,uCAAG,WAAO1J,GAAP,yBAAA1B,EAAA,yDAElByL,EAAwB,GAWnB,QAVHC,EAAYhK,EAAIzC,QAAO,SAACC,EAAWC,GACvC,GAAID,EAAKqB,eAAe,YAAcrB,EAAKf,SAAWqL,EAAgB,CACpE,GAAItK,EAAKf,SAAWqL,GAAmBC,EAGrC,OAAOvK,EAFPuM,EAAmBvM,aAOhB,IAATwM,KAAWC,MAAK,SAAUC,EAAQC,GAAS,IAAD,IACxC,OAAO,UAAAA,EAAEvM,eAAF,eAAW8G,mBAAX,UAA8BwF,EAAEtM,eAAhC,aAA8B,EAAW8G,qBAGzB,IAArBsF,EAAU1M,QAAiByM,EAjBT,uBAkBpBvB,GAAe,GACXO,KACFC,IAAmB,GACnBO,aAAW,IArBO,6BAyBtBf,GAAe,GAGXuB,IACFK,EAAI,YAAOJ,IACN7L,QAAQ4L,GAGTM,EAASC,MAAMC,QAAQH,IAASL,EAAmBK,EAAOJ,EAChE5L,EAA+B,IAAlBiM,EAAO/M,OAAe,CAAC,CAAEkN,SAAU,aAAgBH,KAC5DA,EAAO/M,OAAS,GAAwB,KAAnBwK,GAnCH,wBAoCpBA,EAAiBuC,EAAO,GAAG5N,OAC3BiM,EAAU2B,EAAO,GAAG5N,QAChB4N,EAAO,KAAM,UAAAA,EAAO,UAAP,eAAWI,gBAAiB,IAC3CJ,EAAO,GAAGI,eAAiB,EAC3BC,YAAmBL,EAAO,GAAG5N,SAE/BgM,EAAY4B,EAAO,IA1CC,2BA+ClBA,EAAO/M,OAAS,KACdqN,EAAUN,EAAOO,MAAK,SAACV,GAAD,OAAYA,EAAEzN,QAAUqL,QAE5B,OAAP6C,QAAO,IAAPA,OAAA,EAAAA,EAASF,gBAAiB,IACvCE,EAAQF,eAAiB,EACzBC,YAAmBC,EAAQlO,SAE7BgM,EAAYkC,IAtDQ,4CAAH,sDA0DrBnO,qBAAU,WACR,IAAIqO,EAAc1C,IAAK2C,oBAAmB,SAACC,GACrCA,GACF1C,EAAQ0C,GACR7B,IAAc,KAEdb,GAAQ,GACRa,IAAc,GACdK,aAAW,GACXP,IAAmB,IAEjBf,GACFC,GAAgB,MAIpB,OAAO2C,IACN,CAAC5C,IAIJ,IAAM+C,GAAc,uCAAG,WAAOxN,GAAP,SAAAc,EAAA,sDACrBqL,YAAoB7B,GACpBA,EAAiBtK,EAAKf,OACtBiM,EAAUlL,EAAKf,QACfgM,EAAYjL,GACZkN,YAAmBlN,EAAKf,QALH,2CAAH,sDA4BpB,OAnBAD,qBAAU,WAAO,IAAD,EAYZ,EAXF,GAAImM,EAAa,CACf,IAAIsC,EAAcnN,EAAUP,QAAO,SAACC,GAAD,2BACjCA,EAAKkB,mBAD4B,iBACjC,EAAkB6H,YADe,iBACjC,EACI1C,qBAF6B,aACjC,EAEIG,SAAS2E,EAAY9E,kBAE3B0E,EAAmB0C,IAGlBnN,EAAUR,QAAyC,cAA/B,UAAAQ,EAAU,UAAV,2BACrBiL,KAEmC,cAA/B,UAAAjL,EAAU,UAAV,0BAA2CM,EAAa,IAC5DmL,aAAW,GACXP,IAAmB,MAEpB,CAACL,EAAa7K,IAGf,qBAAK+G,UAAU,cAAf,SACE,sBAAKA,UAAU,mBAAf,UACE,sBAAMA,UAAU,eAAeU,QAAS,kBAAM2D,IAAc,IAA5D,SACE,qBAAKnE,IAAKmG,IAAMhG,IAAI,mBAEtB,sBAAKL,UAAU,yBAAf,UACE,sBAAKA,UAAS,uBAAkBoE,GAAa,SAAW,IAAxD,UACE,wBAAQpE,UAAU,YAAYU,QAAS,kBAAM2D,IAAc,IAA3D,SACE,qBAAKnE,IAAK4C,IAAOzC,IAAI,YAEvB,sBAAKL,UAAU,QAAf,UACE,sBAAMA,UAAU,QAAQ8B,MAAO,CAAEwE,WAAY,QAA7C,kBAIA,sBACEtG,UAAS,qBAAgBgE,EAAe,SAAW,IACnDtD,QAAS,WACPuD,IAAgB,IAHpB,UAME,uBACElF,KAAK,OACLsD,YAAY,SACZM,MAAOmB,EACP3B,SAAU,SAAC5D,GAAD,OACRwF,EAAexF,EAAEK,OAAO+D,MAAMjJ,eAGlC,sBAAMsG,UAAU,kBAAhB,SACE,qBAAKE,IC9NR,qxBD8NyBG,IAAI,gBAG9B,oBAAIL,UAAU,YAAd,SACG8D,EAC4B,IAA3BL,EAAgBhL,OACd,6BACE,mBAAG8N,KAAK,qBAAqBvG,UAAU,OAAvC,SACE,qBAAKA,UAAU,SAAf,SACE,sBAAMA,UAAU,qBAAhB,mCAONyD,EAAgB7B,KAAI,SAACjJ,GAAe,IAAD,UACjC,OACE,oBACE+H,QAAS,WACPyF,GAAexN,IAFnB,SAKE,oBACE4N,KAAK,qBACLvG,UAAS,eACPiD,IAAmBtK,EAAKf,OAAS,SAAW,IAHhD,UAME,wBAAQoI,UAAU,QAAlB,SACE,qBACEE,KAAK,UAAAvH,EAAKkB,mBAAL,eAAkB6C,QAAS8E,IAChCnB,IAAI,MACJG,QAAS,SAACjC,GAAY,IAAD,KACnB,OAAIA,QAAJ,IAAIA,GAAJ,UAAIA,EAAGK,cAAP,aAAI,EAAW6B,WACblC,EAAEK,OAAO6B,QAAU,OAErB,OAAIlC,QAAJ,IAAIA,GAAJ,UAAIA,EAAGK,cAAP,aAAI,EAAWsB,OACb3B,EAAEK,OAAOsB,IAAMsB,UAKvB,sBAAKxB,UAAU,SAAf,UACE,sBAAMA,UAAU,qBAAhB,mBACGrH,EAAKkB,mBADR,aACG,EAAkB6H,OAErB,sBAAM1B,UAAU,yBAAhB,SACGrH,EAAK8C,UAER,mBAAGuE,UAAU,oBAAb,mBACGrH,EAAKI,eADR,aACG,EAAclC,eAEhB,UAAA8B,EAAKI,eAAL,eAAc8G,mBACb,sBAAMG,UAAU,YAAhB,SACGJ,YAAc,UACbjH,EAAKI,eADQ,aACb,EAAc8G,iBACd,eAKLoD,IACDtK,EAAKf,QACH,IADmBe,EAAKiN,eAAZ,KAEZ,sBAAM5F,UAAU,QAAhB,SACGrH,EAAKiN,6BASX,OAAT3M,QAAS,IAATA,OAAA,EAAAA,EAAWR,QAAS,EACtBQ,EAAU2I,KAAI,SAACjJ,GAAe,IAAD,gBAC3B,OACE,oBACE+H,QAAS,WACPyF,GAAexN,IAFnB,SAKE,oBACE4N,KAAK,qBACLvG,UAAS,eACPiD,IAAmBtK,EAAKf,OAAS,SAAW,IAHhD,UAME,wBAAQoI,UAAU,QAAlB,SACE,qBACEE,KAAK,UAAAvH,EAAKkB,mBAAL,eAAkB6C,QAAS8E,IAChCnB,IAAI,MACJG,QAAS,SAACjC,GAAY,IAAD,KACnB,OAAIA,QAAJ,IAAIA,GAAJ,UAAIA,EAAGK,cAAP,aAAI,EAAW6B,WACblC,EAAEK,OAAO6B,QAAU,OAErB,OAAIlC,QAAJ,IAAIA,GAAJ,UAAIA,EAAGK,cAAP,aAAI,EAAWsB,OACb3B,EAAEK,OAAOsB,IAAMsB,UAKvB,sBAAKxB,UAAU,SAAf,UACE,sBAAMA,UAAU,qBAAhB,mBACGrH,EAAKkB,mBADR,aACG,EAAkB6H,OAErB,sBAAM1B,UAAU,yBAAhB,SACGrH,EAAK8C,UAER,mBAAGuE,UAAU,oBAAb,SACiC,UAA9B,UAAArH,EAAKI,eAAL,eAAcF,aAAd,UACCF,EAAKI,eADN,aACC,EAAclC,YACkB,WAA9B,UAAA8B,EAAKI,eAAL,eAAcF,aAChB,mBAAGiJ,MAAO,CAAEC,MAAO,WAAnB,mBACgC,WAA9B,UAAApJ,EAAKI,eAAL,eAAcF,aAChB,mBAAGiJ,MAAO,CAAEC,MAAO,WAAnB,mBAEA,MAGH,UAAApJ,EAAKI,eAAL,eAAc8G,mBACb,sBAAMG,UAAU,YAAhB,SACGJ,YAAc,UACbjH,EAAKI,eADQ,aACb,EAAc8G,iBACd,eAILoD,IACDtK,EAAKf,QACH,IADmBe,EAAKiN,eAAZ,KAEZ,sBAAM5F,UAAU,QAAhB,SACGrH,EAAKiN,4BAQlB7P,EAAMyQ,UAAY,KACpB,6BACE,mBAAGD,KAAK,qBAAqBvG,UAAU,OAAvC,SACE,qBAAKA,UAAU,SAAf,SACE,sBAAMA,UAAU,qBAAhB,2CAkCbkE,GAAkB,KAAQA,IACH,KAAb,OAATjL,QAAS,IAATA,OAAA,EAAAA,EAAWR,QAYX,cAAC,EAAD,CACEb,OAAQqL,EACRrJ,SAAUA,EACVyH,YAAaA,EACbI,QAAS1L,EAAM0L,QACf+E,UAAWzQ,EAAMyQ,UACjBvN,UAAWA,EACXM,aAAcA,IAlBhB,qBAAKyG,UAAU,aAAf,SACE,qBAAKA,UAAU,uBAAf,SACE,sBAAKA,UAAU,YAAf,UACE,wBAAQA,UAAU,SAAlB,SACE,qBAAKE,IAAKuG,IAAQpG,IAAI,qBAExB,iEEzYZqG,EAAgBC,aAZE,SAACpC,GACrB,MAAO,CACHiC,UAAWjC,EAAMqC,OAAOJ,UACxBK,kBAAmBtC,EAAMqC,OAAOC,sBAIb,SAACC,GACxB,OAAOC,YAAmB,GACvBD,KAGeH,CAGpBxD,GAEauD","file":"static/js/30.a482f1bf.chunk.js","sourcesContent":["export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFVSURBVHgB7ZTPTcMwFMbfswTqn0tG6AhhA6cT9ATKjUwATECYoGKC9kbLhQ2oN6AjZAQfaFRU4YedJlUIjmOExKHqJ0WKbL/f5/fZMsBJRy+0Dfb54gYZ8nOVJ1Ik0gXo8acRY2zKlHp8F7FozjOrq4Yj0WSHg1XAZ4ETjrgya4nRxLbGaqCUuiOADIDCNpMDHGCkt7Q+Ux+pjWWNyAqgPKri+j4H2SdRtBVxBr4dGJkCpQvrnZhx040v3NmBtROEORCGxtAH7mXww2QvL7gRAw/1YCsRUNa2JXzg3gY77L9UsehPAsH1cLyY+dR2GpQgDmUsQCyqTAbj5X1XPXbCNQgamQ/5cwiozK0KCDHNX68efm1Qg0sNv2hmXpq8mX+XCbPDl9MKbiKxHehGXK6BKCl2SZTq9+vW24D217GAF6AWbUQ8P5gAtb5ZVrkeub+sPen/9QVDS7zkZB34uAAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAW0lEQVRIS2NkoDFgpLH5DMPMAm7HFf+pEWRf90fAQwYliGhuATVcj27GMIvk4RtEpKYunMkUVxDR3AJK4mY0mRIMPfoGEampBZfzR0tTghGLrIC+kUyS04hUDAD9mBgZUEFJtQAAAABJRU5ErkJggg==\"","export default __webpack_public_path__ + \"static/media/not-found.c5fd5f1f.png\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC4AAAA8CAYAAAAZp4inAAAACXBIWXMAACE4AAAhOAFFljFgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAHpSURBVHgB1Zr/UcJAEIVfHAuwhKMD6UA60AqUDrQCsQQrkA6kA9KBdJDrQDpYd03Qm0zQS3I/9r6Z/SMMwzzefAkXckAHEV3zvPF8UstHd2ygFQ53T+dp5EtBG9Io+fEMTXQ6+PKuRh3HaV8a0qAOTSevOjSPfOrQfBrKoQ6FI606FJZ06lB4GkqgzgXCY3hkuRBXHYpLNHUq+XTExfLcVVV1QEBiqNLHIIY6lJZg6qRQpY9FAHVSqNLHIIA6ORp32fE8cfsWI8kdXLCYoE4OVfoYTFBHQ+Mu3upoCy5YeKijQZU+Bh7qaGzc5aw62oMLFgPqaFSlj8GAOiU07iLqrLn9Y2nBhZqDr0oMLqxLDV6XcHIOYUoNfiw1+KFUxxclNi7XcVtScMuz4tBbOSgl+AvPkkPXpxcuoRtZWK2H1uZaGz+iXc4uz91QaGy8RncC/vUmTY2fWl753HNqabyGR8suuRsf1bJLzsZ/bgowgRzBJagE3mEGqVV55VnMDS2katyibblGIFI0Li0vQ4b+huLR8NwgFhSHDc8VYkJhkT9u0jzXpzDInpcNUkLz2VOOrR80HWn5Ebmg8Vub8rXcC74fEThvyy7UbpT0QZ4Kx73EjYUDPfzT8i20Qu3GyS39Ot9Qih+SiXwBkwmQStsXLyMAAAAASUVORK5CYII=\"","import React, { useState, useEffect, useRef } from \"react\";\nimport { getJobDetails } from \"../../redux/jobs/actions\";\nimport storageService from \"../../utils/storageService\";\n\nimport notFound from \"../../assets/images/not-found.png\";\nimport chatVideoIcon from \"../../assets/images/video@3x.png\";\nimport dummy from \"../../assets/images/u_placeholder.jpg\";\nimport viewMore from \"../../assets/images/icon-direction-blue.png\";\nimport close from \"../../assets/images/ic-cancel-blue.png\";\nimport sendMedia from \"../../assets/images/ic-media.png\";\nimport sendBtn from \"../../assets/images/ic-send.png\";\nimport loader from \"../../assets/images/loader.gif\";\n\nimport { formatDateTime, renderTime } from \"../../utils/common\";\nimport { setShowToast } from \"../../redux/common/actions\";\nimport { onFileUpload } from \"../../redux/auth/actions\";\nimport {\n  getMessagesOfRoom,\n  sendTextMessage,\n  sendImageVideoMessage,\n} from \"../../services/firebase\";\n\nimport Constants from \"../../utils/constants\";\n\n//@ts-ignore\nimport FsLightbox from \"fslightbox-react\";\nimport { moengage, mixPanel } from \"../../services/analyticsTools\";\nimport { MoEConstants } from \"../../utils/constants\";\ninterface Types {\n  [key: string]: any | string;\n}\n\nlet lastDate = \"\";\nconst docTypes: Array<any> = [\"jpeg\", \"jpg\", \"png\", \"mp4\", \"wmv\", \"avi\"];\n\nconst UserMessages = (props: any) => {\n  const divRref = useRef<HTMLDivElement>(null);\n  const [userId] = useState<string>(storageService.getItem(\"userInfo\")?._id);\n  const [toggle, setToggle] = useState<boolean>(false);\n  const [jobDetailLoader, setJobDetailLoader] = useState<boolean>(false);\n  const [currentJobDetails, setCurrentJobDetails] = useState<any>(null);\n  const [messageText, setMessageText] = useState<any>(\"\");\n  const [messages, setMessages] = useState<Array<any>>([]);\n  const [isDocUploading, setIsDocUploading] = useState<boolean>(false);\n\n  const [itemsMedia, setItemsMedia] = useState([]);\n  const [toggler, setToggler] = useState(false);\n  const [selectedSlide, setSelectSlide] = useState<any>(1);\n  const [fsSlideListner, setFsSlideListner] = useState<any>({});\n  const [oppUserFcmToken, setOppUserFcmToken] = useState<any>(\"\");\n\n  useEffect(() => {\n    if (props.roomId !== \"\") {\n      lastDate = \"\";\n      getMessagesOfRoom(props.roomId, onReceiveOfNewMsg);\n      setSelectSlide(1);\n      setFsSlideListner({});\n      setItemsMedia([]);\n      setCurrentJobDetails(null);\n      setToggle(false);\n    }\n  }, [props.roomId]);\n  // }, [props.roomId, props.roomData]);\n  //console.log('props.roomData: ', props.roomData);\n\n  useEffect(() => {\n    scrollToBottom();\n  });\n\n  const scrollToBottom = () => {\n    if (null !== divRref?.current) {\n      const scroll =\n        divRref.current.scrollHeight - divRref.current.clientHeight;\n      // divRref.current.scrollIntoView({ behavior: \"smooth\" })\n      divRref.current.scrollTo(0, scroll);\n    }\n  };\n\n  const onReceiveOfNewMsg = (arrmsg: any) => {\n    // console.log('arrmsg: ', arrmsg);\n    setMessages(arrmsg);\n  };\n\n  useEffect(() => {\n    let fsSlideObj: any = {};\n    let mediaMsgs: any = [];\n    let slideCount = 1;\n    if (messages.length) {\n      mediaMsgs = messages.filter((item: any, index: number) => {\n        if (item.messageType === \"image\" || item.messageType === \"video\") {\n          fsSlideObj[`${index}`] = slideCount++;\n          return item;\n        }\n      });\n      setItemsMedia(mediaMsgs);\n      setFsSlideListner(fsSlideObj);\n    }\n  }, [messages]);\n  // console.log('itemsMedia: ', itemsMedia, \"fsSlideListner\", fsSlideListner);\n\n  const setInboxToTopWithLastMsg = (lastMsg: any) => {\n    const newInboxData = [...props.inBoxData];\n    const currentIndex = newInboxData.findIndex(\n      (i) => i.roomId === props.roomId\n    );\n    newInboxData[currentIndex].lastMsg = lastMsg;\n    newInboxData.splice(currentIndex, 1);\n    newInboxData.unshift(props.inBoxData[currentIndex]);\n    props.setInBoxData(newInboxData);\n    // console.log('lastMsg: ', lastMsg);\n    // console.log('currentIndex: ', currentIndex);\n    // console.log('newInboxData: ', newInboxData);\n  };\n\n  const sendMessage = async () => {\n    //setIsLoading(true);\n    if (messageText && messageText.trimLeft() !== \"\") {\n      setMessageText(\"\");\n      const lastMsg: any = await sendTextMessage(props.roomId, messageText);\n      if (\n        lastMsg &&\n        props.roomData?.oppUserInfo?.deviceToken &&\n        props.roomData?.oppUserInfo?.deviceType &&\n        (props.roomData?.oppUserInfo?.hasOwnProperty(\"isNotification\")\n          ? props.roomData?.oppUserInfo?.isNotification\n          : true)\n      ) {\n        sendFCMPushNotificationToOppUser(lastMsg);\n        const mData = {\n          timeStamp: moengage.getCurrentTimeStamp(),\n        };\n        moengage.moE_SendEvent(MoEConstants.CHAT, mData);\n        mixPanel.mixP_SendEvent(MoEConstants.CHAT, mData);\n      }\n      setInboxToTopWithLastMsg(lastMsg);\n    }\n  };\n\n  const handleKeyDown = (event: any) => {\n    if (!event.shiftKey && event.key === \"Enter\") {\n      event.preventDefault();\n      sendMessage();\n      setMessageText(\"\");\n    }\n  };\n\n  const sendImageVideoMsg = async (url: string, msgType: string) => {\n    //setIsLoading(true);\n    if (url && url !== \"\") {\n      const lastMsg: any = await sendImageVideoMessage(\n        props.roomId,\n        url,\n        msgType\n      );\n      if (\n        lastMsg &&\n        props.roomData?.oppUserInfo?.deviceToken &&\n        props.roomData?.oppUserInfo?.deviceType &&\n        (props.roomData?.oppUserInfo?.hasOwnProperty(\"isNotification\")\n          ? props.roomData?.oppUserInfo?.isNotification\n          : true)\n      ) {\n        sendFCMPushNotificationToOppUser(lastMsg);\n      }\n      setInboxToTopWithLastMsg(lastMsg);\n    }\n    setMessageText(\"\");\n  };\n\n  const fetchJobDetail = async (jobId: any) => {\n    setJobDetailLoader(true);\n    const res = await getJobDetails(jobId);\n    if (res.success) {\n      const jobInfo = {\n        jobDescription: res.data?.details || \"\",\n        jobId: res.data?.jobId || \"\",\n        jobName: res.data?.jobName || \"\",\n        amount: res.data?.amount || \"\",\n        locationName: res.data?.locationName || \"\",\n        fromDate: res.data?.fromDate || \"\",\n        toDate: res.data?.toDate || \"\",\n        duration: res.data?.duration || \"\",\n        status: res.data?.status || \"\",\n      };\n      setCurrentJobDetails(jobInfo);\n      setJobDetailLoader(false);\n    }\n  };\n\n  const renderMediaItems = (itemsMedia: any) => {\n    let sources: any = [];\n    let types: any = [];\n\n    if (itemsMedia.length) {\n      itemsMedia.forEach((item: any) => {\n        if (item.messageType === \"video\") {\n          sources.push(item.mediaUrl);\n          types.push(\"video\");\n        }\n        if (item.messageType === \"image\") {\n          sources.push(item.mediaUrl);\n          types.push(\"image\");\n        }\n      });\n    }\n\n    return { sources, types };\n  };\n\n  const setResDeviceType = (deviceType: number, msg: any) => {\n    switch (Number(deviceType)) {\n      case 1:\n        return {\n          app_icon:\n            \"https://appinventiv-development.s3.amazonaws.com/1628513615740ic-logo-yellow.png\",\n          title: \"Tickt App\",\n          notificationText: `${\n            storageService.getItem(\"userInfo\")?.userName\n          } send you a message`,\n          senderName: `${storageService.getItem(\"userInfo\")?.userName}`,\n          messageType: `${msg?.messageType}`,\n          messageText: `${msg?.messageType === \"text\" ? msg?.messageText : \"\"}`,\n          room_id: msg?.messageRoomId,\n          image: storageService.getItem(\"userInfo\")?.user_image,\n          notificationType: 25,\n          sound: \"default\",\n        };\n      case 2:\n        return {\n          body: msg?.messageText,\n          messageText: msg?.messageText,\n          sender: {\n            first_name: storageService.getItem(\"userInfo\")?.userName,\n            device_token: storageService.getItem(\"fcmToken\"),\n            user_id: storageService.getItem(\"userInfo\")?._id,\n            device_type: 2,\n          },\n          jobId: msg?.messageRoomId?.split(\"_\")?.[0],\n          badge: 1,\n          device_type: 2,\n          title: storageService.getItem(\"userInfo\")?.userName,\n          jobName: props.roomData?.jobName,\n          notification_type: 50,\n          sound: \"default\",\n          messageId: msg?.messageId,\n        };\n      case 3:\n        return {\n          notification: {\n            body: msg?.messageText,\n            title: storageService.getItem(\"userInfo\")?.userName,\n          },\n          data: {\n            body: msg?.messageText,\n            messageText: msg?.messageText,\n            sender: {\n              first_name: storageService.getItem(\"userInfo\")?.userName,\n              device_token: storageService.getItem(\"fcmToken\"),\n              user_id: storageService.getItem(\"userInfo\")?._id,\n              device_type: 2,\n            },\n            jobId: msg?.messageRoomId?.split(\"_\")?.[0],\n            badge: 1,\n            device_type: 2,\n            title: storageService.getItem(\"userInfo\")?.userName,\n            jobName: props.roomData?.jobName,\n            notification_type: 50,\n            sound: \"default\",\n            messageId: msg?.messageId,\n          },\n        };\n      default:\n        return;\n    }\n  };\n  const sendFCMPushNotificationToOppUser = async (msg: any) => {\n    let data = setResDeviceType(props.roomData?.oppUserInfo?.deviceType, msg);\n    let newData = {\n      to: `${props.roomData?.oppUserInfo?.deviceToken}`,\n      ...(props.roomData?.oppUserInfo?.deviceType == 1 && { data: data }),\n      ...(props.roomData?.oppUserInfo?.deviceType == 2 && {\n        notification: data,\n      }),\n      ...(props.roomData?.oppUserInfo?.deviceType == 3 && {\n        notification: data?.notification,\n        data: data?.data,\n      }),\n    };\n\n    const headers_: Types = {\n      \"Content-Type\": \"application/json\",\n      Authorization: Constants.FcmHeaderAuthorizationKey,\n    };\n    const response: any = await fetch(`https://fcm.googleapis.com/fcm/send`, {\n      method: \"POST\",\n      headers: headers_,\n      body: JSON.stringify(newData),\n    });\n    // const res: any = await response.json();\n    if (response.status === 200) {\n      console.log(\"Chat push notification send to opposite user: success\");\n    } else {\n      console.log(\"Chat push notification send to opposite user: failure\");\n    }\n  };\n\n  const handleUpload = async (e: any) => {\n    let maxFileSize: number = 10;\n    const formData = new FormData();\n    const newFile = e.target.files[0];\n    var fileType = newFile?.type?.split(\"/\")[1]?.toLowerCase();\n\n    var selectedFileSize = newFile?.size / 1024 / 1024; // size in mb\n    if ([\"mp4\", \"wmv\", \"avi\"].includes(fileType)) {\n      maxFileSize = 20;\n    }\n    if (docTypes.indexOf(fileType) < 0 || selectedFileSize > maxFileSize) {\n      setShowToast(true, \"The file must be in proper format or size\");\n      return;\n    }\n\n    formData.append(\"file\", newFile);\n    setIsDocUploading(true);\n    let check_type: any = [\"jpeg\", \"jpg\", \"png\"].includes(fileType)\n      ? 1\n      : [\"mp4\", \"wmv\", \"avi\"].includes(fileType)\n      ? 2\n      : null;\n    const res = await onFileUpload(formData);\n    if (res.success && res.imgUrl) {\n      if (check_type === 1) {\n        sendImageVideoMsg(res.imgUrl, \"image\");\n      } else if (check_type === 2) {\n        sendImageVideoMsg(res.imgUrl, \"video\");\n      } else {\n        setShowToast(true, \"There is some technical issue\");\n      }\n      setIsDocUploading(false);\n      // setLocalFiles((prev: any) => ({ ...prev, [filesUrl?.length]: URL.createObjectURL(newFile) }));\n    }\n  };\n\n  const renderTextMsg = (msg: any) => {\n    let curDate = formatDateTime(msg.messageTimestamp, \"day\");\n    const messageClass =\n      msg.senderId === userId ? \"message\" : \"message recive_msg\";\n    if (lastDate === \"\" || lastDate !== curDate) {\n      lastDate = curDate;\n      return (\n        <>\n          <div className=\"date_time\">\n            <span>{curDate}</span>\n          </div>\n          <div className={`${messageClass}`}>\n            <p className={`${msg.senderId === userId ? \"mark\" : \"\"}`}>\n              {msg.messageText}\n              <span className=\"time\">\n                {formatDateTime(msg.messageTimestamp, \"time\")}\n              </span>\n            </p>\n          </div>\n        </>\n      );\n    } else\n      return (\n        <div className={`${messageClass}`}>\n          <p className={`${msg.senderId === userId ? \"mark\" : \"\"}`}>\n            {msg.messageText}\n            <span className=\"time\">\n              {formatDateTime(msg.messageTimestamp, \"time\")}\n            </span>\n          </p>\n        </div>\n      );\n  };\n\n  const renderImageMsg = (msg: any, index: number) => {\n    let curDate = formatDateTime(msg.messageTimestamp, \"day\");\n    const messageClass =\n      msg.senderId === userId ? \"message\" : \"message recive_msg\";\n    if (lastDate === \"\" || lastDate !== curDate) {\n      lastDate = curDate;\n      return (\n        <>\n          <div className=\"date_time\">\n            <span>{curDate}</span>\n          </div>\n          <div className={`${messageClass}`}>\n            <figure className=\"media\">\n              <img\n                src={msg.mediaUrl || notFound}\n                alt=\"media\"\n                async-src={msg.mediaUrl || notFound}\n                decoding=\"async\"\n                loading=\"lazy\"\n                onError={(e: any) => {\n                  if (e?.target?.onerror) {\n                    e.target.onerror = null;\n                  }\n                  if (e?.target?.src) {\n                    e.target.src = notFound;\n                  }\n                }}\n                onClick={() => {\n                  setToggler((prev: any) => !prev);\n                  setSelectSlide(fsSlideListner[`${index}`]);\n                }}\n              />\n              <span className=\"time\">\n                {formatDateTime(msg.messageTimestamp, \"time\")}\n              </span>\n            </figure>\n          </div>\n        </>\n      );\n    } else\n      return (\n        <div className={`${messageClass}`}>\n          <figure className=\"media\">\n            <img\n              src={msg.mediaUrl || notFound}\n              alt=\"media\"\n              async-src={msg.mediaUrl || notFound}\n              decoding=\"async\"\n              loading=\"lazy\"\n              onError={(e: any) => {\n                if (e?.target?.onerror) {\n                  e.target.onerror = null;\n                }\n                if (e?.target?.src) {\n                  e.target.src = notFound;\n                }\n              }}\n              onClick={() => {\n                setToggler((prev: any) => !prev);\n                setSelectSlide(fsSlideListner[`${index}`]);\n              }}\n            />\n            <span className=\"time\">\n              {formatDateTime(msg.messageTimestamp, \"time\")}\n            </span>\n          </figure>\n        </div>\n      );\n  };\n\n  const renderVideoMsg = (msg: any, index: number) => {\n    let curDate = formatDateTime(msg.messageTimestamp, \"day\");\n    const messageClass =\n      msg.senderId === userId ? \"message\" : \"message recive_msg\";\n    if (lastDate === \"\" || lastDate !== curDate) {\n      lastDate = curDate;\n      return (\n        <>\n          <div className=\"date_time\">\n            <span>{curDate}</span>\n          </div>\n          <div className={`${messageClass}`}>\n            <figure className=\"media media_video \">\n              <video\n                src={msg.mediaUrl || notFound}\n                poster={chatVideoIcon}\n                onClick={() => {\n                  setToggler((prev: any) => !prev);\n                  setSelectSlide(fsSlideListner[`${index}`]);\n                }}\n              />\n              <span className=\"time\">\n                {formatDateTime(msg.messageTimestamp, \"time\")}\n              </span>\n            </figure>\n          </div>\n        </>\n      );\n    } else\n      return (\n        <div className={`${messageClass}`}>\n          <figure className=\"media media_video \">\n            <video\n              src={msg.mediaUrl || notFound}\n              poster={chatVideoIcon}\n              onClick={() => {\n                setToggler((prev: any) => !prev);\n                setSelectSlide(fsSlideListner[`${index}`]);\n              }}\n            />\n            <span className=\"time\">\n              {formatDateTime(msg.messageTimestamp, \"time\")}\n            </span>\n          </figure>\n        </div>\n      );\n  };\n\n  const displayMessages = (msg: any, index: number) => {\n    if (index === 0) lastDate = \"\";\n    switch (msg.messageType) {\n      case \"text\":\n        return renderTextMsg(msg);\n      case \"image\":\n        return renderImageMsg(msg, index);\n      case \"video\":\n        return renderVideoMsg(msg, index);\n    }\n  };\n\n  const { sources, types } = renderMediaItems(itemsMedia);\n\n  return props.isNoRecords ? (\n    <div className=\"detail_col\">\n      <div className=\"flex_row\">\n        {/* <div>No Record Found</div> */}\n        <div></div>\n      </div>\n    </div>\n  ) : (\n    <>\n      <FsLightbox\n        toggler={toggler}\n        slide={selectedSlide}\n        sources={sources}\n        types={types}\n        key={sources?.length}\n        // disableLocalStorage={true}\n        onClose={() => {\n          setSelectSlide(1);\n        }}\n      />\n      <div className=\"detail_col\">\n        <div className=\"flex_row\">\n          <div className={`chat_col ${toggle ? \"active\" : \"\"}`}>\n            <div className=\"chat_user\">\n              <figure className=\"u_img\">\n                <img\n                  src={props.roomData?.oppUserInfo?.image || dummy}\n                  alt=\"user-img\"\n                  onError={(e: any) => {\n                    if (e?.target?.onerror) {\n                      e.target.onerror = null;\n                    }\n                    if (e?.target?.src) {\n                      e.target.src = dummy;\n                    }\n                  }}\n                />\n              </figure>\n              <span\n                className=\"name\"\n                onClick={() => {\n                  if (storageService.getItem(\"userType\") === 2) {\n                    props.history.push(\n                      `/tradie-info?tradeId=${props.roomData?.oppUserInfo?.userId}&hideInvite=true`\n                    );\n                  } else {\n                    props.history.push(\n                      `/builder-info?builderId=${props.roomData?.oppUserInfo?.userId}`\n                    );\n                  }\n                }}\n              >\n                {props.roomData?.oppUserInfo?.name}\n              </span>\n              {!toggle && (\n                <span\n                  onClick={() => {\n                    setToggle(true);\n                    if (currentJobDetails) return;\n                    fetchJobDetail(props.roomData?.jobId);\n                  }}\n                  className=\"view_detail\"\n                >\n                  View Job Details\n                  <img src={viewMore} alt=\"view-more\" />\n                </span>\n              )}\n            </div>\n            <div className=\"message_wrapr\" ref={divRref}>\n              {messages.length > 0 &&\n                messages.map((msg: any, index: number) => {\n                  return displayMessages(msg, index);\n                })}\n              <div className=\"date_time\">\n                {props.roomData?.oppUserInfo?.isBlock && (\n                  <i style={{ color: \"#929292\" }}>\n                    {\"You can no longer chat with the user\"}\n                  </i>\n                )}\n              </div>\n            </div>\n\n            {!props.roomData?.oppUserInfo?.isBlock && (\n              <div className=\"send_msg\">\n                <div className=\"text_field\">\n                  <label className=\"upload_item\" htmlFor=\"upload_item\">\n                    <span className=\"detect_icon_ltr\">\n                      <img src={sendMedia} alt=\"media\" />\n                    </span>\n                  </label>\n                  <input\n                    id=\"upload_item\"\n                    className=\"hide\"\n                    type=\"file\"\n                    accept=\"image/png,image/jpg,image/jpeg, video/mp4, video/wmv, video/avi\"\n                    onChange={handleUpload}\n                    disabled={isDocUploading}\n                  />\n                  <textarea\n                    placeholder=\"Message..\"\n                    onKeyDown={handleKeyDown}\n                    value={messageText}\n                    onChange={(e) => setMessageText(e.target.value)}\n                  />\n                  <span className=\"detect_icon\">\n                    <img src={sendBtn} alt=\"send\" onClick={sendMessage} />\n                  </span>\n                </div>\n              </div>\n            )}\n          </div>\n\n          {toggle && jobDetailLoader ? (\n            <div className=\"view_detail_col\">\n              <div className=\"no_record\">\n                <figure>\n                  <img src={loader} alt=\"loader\" width=\"130px\" />\n                </figure>\n              </div>\n            </div>\n          ) : toggle ? (\n            <div className=\"view_detail_col\">\n              <div className=\"f_spacebw relative\">\n                <span className=\"title line-2 pr-20\">\n                  {currentJobDetails?.jobName}\n                </span>\n                <span\n                  onClick={() => {\n                    setToggle((prev) => !prev);\n                  }}\n                  className=\"close\"\n                >\n                  <img src={close} alt=\"close\" />\n                </span>\n              </div>\n\n              <div className=\"job_info\">\n                <ul>\n                  <li className=\"icon clock\">\n                    {renderTime(\n                      currentJobDetails?.fromDate,\n                      currentJobDetails?.toDate\n                    )}\n                  </li>\n                  <li className=\"icon dollar\">{currentJobDetails?.amount}</li>\n                  <li className=\"icon location line-1\">\n                    {currentJobDetails?.locationName}\n                  </li>\n                  <li className=\"icon calendar\">\n                    {currentJobDetails?.duration}\n                  </li>\n                </ul>\n              </div>\n\n              <p className=\"commn_para\">{currentJobDetails?.jobDescription}</p>\n\n              <button\n                className=\"fill_btn full_btn btn-effect\"\n                onClick={() => {\n                  if (storageService.getItem(\"userType\") === 1) {\n                    props.history.push(\n                      `/job-details-page?jobId=${currentJobDetails?.jobId}&redirect_from=jobs`\n                    );\n                  } else {\n                    // let urlEncode: any = window.btoa(`?jobId=${currentJobDetails?.jobId}&status=${currentJobDetails?.status}&edit=true&activeType=active`)\n                    let urlEncode: any = `?jobId=${currentJobDetails?.jobId}&status=${currentJobDetails?.status}&edit=true&activeType=active`;\n                    props.history.push(`/job-detail?${urlEncode}`);\n                  }\n                }}\n              >\n                View Job details\n              </button>\n            </div>\n          ) : null}\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default UserMessages;\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACWSURBVHgB7ZTBDYAgDEWLejBOgZvIGE6oW+gmMoYXxdZwMF7kkxA88C4EQvtIKRAVcqOQzZ2ZNwk4nDP7OtqQmIpwdK3U0g6TDtkMCU4+uSOyiAQqkSBJK07OgZqn9qtcsACVRAkQSbQgVNK8g3wrasK5L57H/rkY06YQyUv0z0tO2qZJHxqaXIC6CE0OCzwW+a4L+bkA+mx0ERNXUvgAAAAASUVORK5CYII=\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAMAAAC7IEhfAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAABXUExURUdwTP///////////////////////////////////////wtBqODn9KC13YWg1GaIyWaJyEhwvsLP6RpNrSlZs/Dz+tHb73aUzld8xLPD5DlkubLD5Fd9wl7Mg6UAAAAKdFJOUwDfn6C/cIAcc+/XmZsvAAABPklEQVQ4y5WV7ZpFIBSFOSc87b7sSmHm/q9zImbihGb9iafXqrVjq6qoriU1fIiSpqtSdQQu9U7QhsKNaLNzLTyo3fzgUatnR59BuuzzBQUiwRCK1JXsMOYhZSCpDlEGqaTQbvgE6+pwq2bhv9EyM+P6RDJ1BO02xfUkPc6GWZcH2WnRQdgMOMiRqVQiWLMMqFAeZT3onCNzp6TcwIQ5kO8AzmIdGYjxDrR+MjqCXt6AS4BRxIt1vHQMxTY8gqgvQD2GKe77JRdXDIzLg94IYcRWVdOz5ARSUCMGU2eXANqi5syZ3Fkz42MYqya0X8se9ZwFp72OPcphDSMR7lL/ngwzvAh06cuUgKjEUajSF/evNYXyHSUTQ1r+cbVlYFPeAMrWfv2nSRW3vfJGWt6awz7fNxU8/RcakrGtSbtjP7Y8P8bN8RBFAAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYBAMAAAASWSDLAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAnUExURUdwTAtBqApBqApBqAtApwpApwtBqApBqAhApxBAnwlApwtApwtBqA/NXNUAAAAMdFJOUwDBf99gQO+hIBBwkA7bl6QAAACoSURBVBjTY2CAA1ZhBHtSzkE4O/BYzhEok1Pt4OozBlDlMtkBOsoFUOVSE5gO+TRAlG9lYNBREIQoX8nAwHSI4whEOQNIgh2o30ZqAgNIgoEZqN/5eANYggGs3/l4AEiCQRBssPPBAKAEB9R+54NACXao/QzOAgxg/RDXHGWA6AcDQZh+EIgJgOkHAmYBuH4GBpajcP1AYIjQDzQrEcFmYDuCxOEC6wcA6NUlu1h0PO0AAAAASUVORK5CYII=\"","import React, { useState, useEffect } from \"react\";\n\nimport dummy from \"../../assets/images/u_placeholder.jpg\";\nimport chatSearch from \"../../assets/images/search-chat.png\";\nimport menu from \"../../assets/images/menu-line-blue.png\";\nimport close from \"../../assets/images/ic-cancel-blue.png\";\n\nimport { setLoading } from \"../../redux/common/actions\";\nimport { formatDateTime } from \"../../utils/common\";\nimport noData from \"../../assets/images/no-search-data.png\";\nimport emptyChat from \"../../assets/images/emptyChat.png\";\n\nimport {\n  auth,\n  createRoom,\n  checkRoomExist,\n  getFirebaseInboxData,\n  stopListeningOfRoom,\n  resetUnreadCounter,\n} from \"../../services/firebase\";\n\nimport UserMessages from \"./userMessages\";\n\ninterface PropTypes {\n  builderProfile: any;\n  tradieProfileData: any;\n  isLoading: boolean;\n  history: any;\n}\n\nlet selectedRoomID = \"\";\nlet isFreshChatRoute: boolean = false;\n\nconst Chat = (props: PropTypes) => {\n  const [initializing, setInitializing] = useState<boolean>(true);\n  // firebase authenticated user details\n  const [user, setUser] = useState<any>(() => auth.currentUser);\n  const [inBoxData, setInBoxData] = useState<any>([]);\n  const [filterInBoxData, setFilterInBoxData] = useState<any>([]);\n  const [isNoRecords, setIsNoRecords] = useState<boolean>(false);\n  const [roomData, setRoomData] = useState<any>({});\n  const [roomId, setRoomId] = useState<string>(\"\");\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [searchActive, setSearchActive] = useState(false);\n  const [isInitialLoader, setIsInitialLoader] = useState(true);\n  const [isMobInbox, setIsMobInbox] = useState<boolean>(false);\n\n  const { tradieId, builderId, jobName, jobId } = props.history?.location?.state\n    ? props.history?.location?.state\n    : { tradieId: \"\", builderId: \"\", jobName: \"\", jobId: \"\" };\n  // console.log('tradieId, builderId, jobName, jobId: ', tradieId, builderId, jobName, jobId);\n\n  useEffect(() => {\n    //  console.log(\"roomId:: from didmout\", selectedRoomID);\n    (async () => {\n      setLoading(true);\n      if (tradieId && builderId && jobName && jobId) {\n        await setInitialItems();\n      } else {\n        isFreshChatRoute = true;\n      }\n      await getFirebaseInboxData(onUpdateofInbox);\n      // debugger;\n    })();\n\n    return () => {\n      // debugger;\n      stopListeningOfRoom(selectedRoomID);\n      selectedRoomID = \"\";\n    };\n  }, []);\n\n  const setInitialItems = async () => {\n    const roomID: string = `${jobId}_${tradieId}_${builderId}`;\n    selectedRoomID = roomID;\n    if (await checkRoomExist(roomID)) {\n      //console.log('RoomAlreadyExist: =================>');\n      return;\n    } else {\n      await createRoom(jobId, tradieId, builderId, jobName);\n      // console.log('NewRoomCreated: ============>');\n    }\n  };\n\n  const onUpdateofInbox = async (res: any) => {\n    //  console.log(\"roomId::\", selectedRoomID);\n    let selectedRoomInfo: any = \"\";\n    const sortedRes = res.filter((item: any, index: number) => {\n      if (item.hasOwnProperty(\"lastMsg\") || item.roomId === selectedRoomID) {\n        if (item.roomId === selectedRoomID && !isFreshChatRoute) {\n          selectedRoomInfo = item;\n        } else {\n          return item;\n        }\n      }\n    });\n\n    sortedRes?.sort(function (x: any, y: any) {\n      return y.lastMsg?.messageTimestamp - x.lastMsg?.messageTimestamp;\n    });\n\n    if (sortedRes.length === 0 && !selectedRoomInfo) {\n      setIsNoRecords(true);\n      if (isInitialLoader) {\n        setIsInitialLoader(false);\n        setLoading(false);\n      }\n      return;\n    }\n    setIsNoRecords(false);\n\n    let ress: any;\n    if (selectedRoomInfo) {\n      ress = [...sortedRes];\n      ress.unshift(selectedRoomInfo);\n    }\n    // console.log('ress: ', ress, \"sortedRes\", sortedRes, \"res\", res, \"selectedRoomInfo\", selectedRoomInfo);\n    const newRes = Array.isArray(ress) && selectedRoomInfo ? ress : sortedRes;\n    setInBoxData(newRes.length === 0 ? [{ firstKey: \"emptyRes\" }] : newRes);\n    if (newRes.length > 0 && selectedRoomID === \"\") {\n      selectedRoomID = newRes[0].roomId;\n      setRoomId(newRes[0].roomId);\n      if (newRes[0] && newRes[0]?.unreadMessages > 0) {\n        newRes[0].unreadMessages = 0;\n        resetUnreadCounter(newRes[0].roomId);\n      }\n      setRoomData(newRes[0]);\n      return;\n      // fetchJobDetail(res[0].item?.jobId);\n    }\n\n    if (newRes.length > 0) {\n      let itemObj = newRes.find((x: any) => x.roomId == selectedRoomID);\n\n      if (itemObj && itemObj?.unreadMessages > 0) {\n        itemObj.unreadMessages = 0;\n        resetUnreadCounter(itemObj.roomId);\n      }\n      setRoomData(itemObj);\n    }\n  };\n\n  useEffect(() => {\n    let unsubscribe = auth.onAuthStateChanged((user) => {\n      if (user) {\n        setUser(user);\n        setIsMobInbox(false);\n      } else {\n        setUser(false);\n        setIsMobInbox(true);\n        setLoading(false);\n        setIsInitialLoader(false);\n      }\n      if (initializing) {\n        setInitializing(false);\n      }\n    });\n\n    return unsubscribe;\n  }, [initializing]);\n\n  // console.log(props.history, \"history\", roomId, \"roomId\", roomData, \"roomData\", selectedRoomID, \"selectedRoomID\", inBoxData, 'inBoxData');\n\n  const getRoomDetails = async (item: any) => {\n    stopListeningOfRoom(selectedRoomID);\n    selectedRoomID = item.roomId;\n    setRoomId(item.roomId);\n    setRoomData(item);\n    resetUnreadCounter(item.roomId);\n    // fetchEquipmentDetail(item.itemId);\n  };\n\n  useEffect(() => {\n    if (searchQuery) {\n      let filteredVal = inBoxData.filter((item: any) =>\n        item.oppUserInfo?.name\n          ?.toLowerCase()\n          ?.includes(searchQuery.toLowerCase())\n      );\n      setFilterInBoxData(filteredVal);\n    }\n    if (\n      (inBoxData.length || inBoxData[0]?.[\"firstKey\"] === \"emptyRes\") &&\n      isInitialLoader\n    ) {\n      if (inBoxData[0]?.[\"firstKey\"] === \"emptyRes\") setInBoxData([]);\n      setLoading(false);\n      setIsInitialLoader(false);\n    }\n  }, [searchQuery, inBoxData]);\n\n  return (\n    <div className=\"app_wrapper\">\n      <div className=\"custom_container\">\n        <span className=\"mob_side_nav\" onClick={() => setIsMobInbox(true)}>\n          <img src={menu} alt=\"mob-side-nav\" />\n        </span>\n        <div className=\"f_row chat_wrapr h-100\">\n          <div className={`side_nav_col ${isMobInbox ? \"active\" : \"\"}`}>\n            <button className=\"close_nav\" onClick={() => setIsMobInbox(false)}>\n              <img src={close} alt=\"close\" />\n            </button>\n            <div className=\"stick\">\n              <span className=\"title\" style={{ marginLeft: \"50px\" }}>\n                Chat\n              </span>\n\n              <div\n                className={`search_bar ${searchActive ? \"active\" : \"\"}`}\n                onClick={() => {\n                  setSearchActive(true);\n                }}\n              >\n                <input\n                  type=\"text\"\n                  placeholder=\"Search\"\n                  value={searchQuery}\n                  onChange={(e: any) =>\n                    setSearchQuery(e.target.value.trimLeft())\n                  }\n                />\n                <span className=\"detect_icon_ltr\">\n                  <img src={chatSearch} alt=\"search\" />\n                </span>\n              </div>\n              <ul className=\"chat_list\">\n                {searchQuery ? (\n                  filterInBoxData.length === 0 ? (\n                    <li>\n                      <a href=\"javascript:void(0)\" className=\"chat\">\n                        <div className=\"detail\">\n                          <span className=\"inner_title line-1\">\n                            No Record Found\n                          </span>\n                        </div>\n                      </a>\n                    </li>\n                  ) : (\n                    filterInBoxData.map((item: any) => {\n                      return (\n                        <li\n                          onClick={() => {\n                            getRoomDetails(item);\n                          }}\n                        >\n                          <a\n                            href=\"javascript:void(0)\"\n                            className={`chat ${\n                              selectedRoomID === item.roomId ? \"active\" : \"\"\n                            }`}\n                          >\n                            <figure className=\"u_img\">\n                              <img\n                                src={item.oppUserInfo?.image || dummy}\n                                alt=\"img\"\n                                onError={(e: any) => {\n                                  if (e?.target?.onerror) {\n                                    e.target.onerror = null;\n                                  }\n                                  if (e?.target?.src) {\n                                    e.target.src = dummy;\n                                  }\n                                }}\n                              />\n                            </figure>\n                            <div className=\"detail\">\n                              <span className=\"inner_title line-1\">\n                                {item.oppUserInfo?.name}\n                              </span>\n                              <span className=\"inner_title job line-1\">\n                                {item.jobName}\n                              </span>\n                              <p className=\"commn_para line-1\">\n                                {item.lastMsg?.messageText}\n                              </p>\n                              {item.lastMsg?.messageTimestamp && (\n                                <span className=\"date_time\">\n                                  {formatDateTime(\n                                    item.lastMsg?.messageTimestamp,\n                                    \"inboxTime\"\n                                  )}\n                                </span>\n                              )}\n\n                              {selectedRoomID ===\n                              item.roomId ? null : item.unreadMessages ===\n                                0 ? null : (\n                                <span className=\"count\">\n                                  {item.unreadMessages}\n                                </span>\n                              )}\n                            </div>\n                          </a>\n                        </li>\n                      );\n                    })\n                  )\n                ) : inBoxData?.length > 0 ? (\n                  inBoxData.map((item: any) => {\n                    return (\n                      <li\n                        onClick={() => {\n                          getRoomDetails(item);\n                        }}\n                      >\n                        <a\n                          href=\"javascript:void(0)\"\n                          className={`chat ${\n                            selectedRoomID === item.roomId ? \"active\" : \"\"\n                          }`}\n                        >\n                          <figure className=\"u_img\">\n                            <img\n                              src={item.oppUserInfo?.image || dummy}\n                              alt=\"img\"\n                              onError={(e: any) => {\n                                if (e?.target?.onerror) {\n                                  e.target.onerror = null;\n                                }\n                                if (e?.target?.src) {\n                                  e.target.src = dummy;\n                                }\n                              }}\n                            />\n                          </figure>\n                          <div className=\"detail\">\n                            <span className=\"inner_title line-1\">\n                              {item.oppUserInfo?.name}\n                            </span>\n                            <span className=\"inner_title job line-1\">\n                              {item.jobName}\n                            </span>\n                            <p className=\"commn_para line-1\">\n                              {item.lastMsg?.messageType === \"text\" ? (\n                                item.lastMsg?.messageText\n                              ) : item.lastMsg?.messageType === \"image\" ? (\n                                <i style={{ color: \"#929292\" }}>Photo</i>\n                              ) : item.lastMsg?.messageType === \"video\" ? (\n                                <i style={{ color: \"#929292\" }}>Video</i>\n                              ) : (\n                                \"\"\n                              )}\n                            </p>\n                            {item.lastMsg?.messageTimestamp && (\n                              <span className=\"date_time\">\n                                {formatDateTime(\n                                  item.lastMsg?.messageTimestamp,\n                                  \"inboxTime\"\n                                )}\n                              </span>\n                            )}\n                            {selectedRoomID ===\n                            item.roomId ? null : item.unreadMessages ===\n                              0 ? null : (\n                              <span className=\"count\">\n                                {item.unreadMessages}\n                              </span>\n                            )}\n                          </div>\n                        </a>\n                      </li>\n                    );\n                  })\n                ) : props.isLoading ? null : (\n                  <li>\n                    <a href=\"javascript:void(0)\" className=\"chat\">\n                      <div className=\"detail\">\n                        <span className=\"inner_title line-1\">\n                          No Record Found\n                        </span>\n                      </div>\n\n                      {/* <div className=\"detail\">\n                        <span className=\"no_record\">\n                          <figure>\n                            <figure className=\"no_img\">\n                              <img src={emptyChat} alt=\"data not found\" />\n                            </figure>\n                          </figure>\n\n                          <span className=\"empty_screen_text\">\n                            You don't have any chat messages yet.\n                          </span>\n                          <span className=\"empty_screen_subtext\">\n                            Connect to your local network\n                          </span>\n                          <button\n                            className=\"empty_screen_button\"\n                            onClick={() => props.history.push(\"/\")}\n                          >\n                            View Recommended tradespeople\n                          </button>\n                        </span>\n                      </div> */}\n                    </a>\n                  </li>\n                )}\n              </ul>\n            </div>\n          </div>\n          {/* {(isInitialLoader || inBoxData?.length === 0) ? null : */}\n          {isInitialLoader ? null : !isInitialLoader &&\n            inBoxData?.length === 0 ? (\n            <div className=\"detail_col\">\n              <div className=\"flex_row tradies_row\">\n                <div className=\"no_record\">\n                  <figure className=\"no_img\">\n                    <img src={noData} alt=\"data not found\" />\n                  </figure>\n                  <span>No Data Found</span>\n                </div>\n              </div>\n            </div>\n          ) : (\n            <UserMessages\n              roomId={selectedRoomID}\n              roomData={roomData}\n              isNoRecords={isNoRecords}\n              history={props.history}\n              isLoading={props.isLoading}\n              inBoxData={inBoxData}\n              setInBoxData={setInBoxData}\n            />\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Chat;\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAqCAMAAADyHTlpAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAABUUExURUdwTPLy8vHx8e/v7/Hx8e/v7+/v7+/v7+/v7/Dw8PPz8/Hx8e/v7/////n5+fPz9BIOJIiGkU1KW3FufMnIzSAdMeLh5C8sP1xZaJeVnz47TaalreepWhcAAAANdFJOUwC/32CaEIBAJHB/71CwYgcnAAABbklEQVQ4y52V25aDIAxFRUShKkFQ8fL//znQWg0otp08qEv3OhwDSbIsCsapKEvRVNl9MEFqkD4AgFCeBCvisHYPhxfXMCsAcW/6Cq7yE/iE85NpAZekF36E5APaZITsHelYgXzeko7d/fJc3qMyZxtafCAdW2yieHmYjdbdmLCARedBWb0oZSJYkljUqKl3t7FTNmLBu6UH2qlue+oHHcn6hJF9/VGZw4nqzw4O0VWhVWPZmuH0Twv6ZIbILM+aA9VYqFORWZoJ+Z2q+69SIiGUtyVOQYnRfs+Vf15PKDLQTnuGRmvbkwGKULDD/NK0KMXbtyY8LKNW1nTGX5GZ94FhdfBmnQY16BnQJm9osLFhhOxzY0XqYAcsUN8qkoWFWXi2DiLTbB9WzE299qHoL2WYsc/FzX9vGb653ZIlblolfEt6Ntk0xf9bsWsd1w2eXU4DB2PajRmSHkmcEjeFXtOoJoJ9mF1V40cc5SfuDwSERuTh1ludAAAAAElFTkSuQmCC\"","import { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport Chat from './chat';\n\nconst mapStateToProps = (state: any) => {\n    return {\n        isLoading: state.common.isLoading,\n        isSkeletonLoading: state.common.isSkeletonLoading,\n    }\n}\n\nconst mapDispatchToProps = (dispatch: any) => {\n    return bindActionCreators({\n    }, dispatch);\n}\n\nconst ChatComponent = connect(\n    mapStateToProps,\n    mapDispatchToProps\n)(Chat)\n\nexport default ChatComponent;"],"sourceRoot":""}