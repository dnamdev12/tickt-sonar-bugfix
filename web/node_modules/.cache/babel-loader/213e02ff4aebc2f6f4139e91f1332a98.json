{"ast":null,"code":"import _objectSpread from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';// @ts-ignore\nimport{DragDropContext,Droppable,Draggable}from'react-beautiful-dnd';import moment from'moment';import{setShowToast}from'../../../redux/common/actions';import milestonesPlaceholder from'../../../assets/images/Job milestones-preview.png';import Button from'@material-ui/core/Button';import Dialog from'@material-ui/core/Dialog';import DialogActions from'@material-ui/core/DialogActions';import DialogTitle from'@material-ui/core/DialogTitle';import{useLocation}from\"react-router-dom\";import{renderTimeWithFormat}from'../../../utils/common';// please arrange milestone date wise.\n// milestone start date should be doffent from another can not be.\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var JobMilestones=function JobMilestones(_ref){var data=_ref.data,stepCompleted=_ref.stepCompleted,newMileStoneScreen=_ref.newMileStoneScreen,editDetailPage=_ref.editDetailPage,editMileStone=_ref.editMileStone,editMilestoneTiming=_ref.editMilestoneTiming,handleStepJustUpdate=_ref.handleStepJustUpdate,handleCombineMileStones=_ref.handleCombineMileStones,removeMilestoneByIndex=_ref.removeMilestoneByIndex,handleStepForward=_ref.handleStepForward,updateMileStoneIndex=_ref.updateMileStoneIndex,updateMileStoneTimings=_ref.updateMileStoneTimings,milestones=_ref.milestones,handleStepComplete=_ref.handleStepComplete,handleStepBack=_ref.handleStepBack;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),localMilestones=_useState2[0],setLocalMilestones=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),editItem=_useState4[0],setEditItems=_useState4[1];var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),open=_React$useState2[0],setOpen=_React$useState2[1];var _React$useState3=React.useState(null),_React$useState4=_slicedToArray(_React$useState3,2),deleteItem=_React$useState4[0],setDeleteItem=_React$useState4[1];var _React$useState5=React.useState([]),_React$useState6=_slicedToArray(_React$useState5,2),sortedItems=_React$useState6[0],setSortedItems=_React$useState6[1];var location=useLocation();var jobId=null;if(location.search){var urlParams=new URLSearchParams(location.search);jobId=urlParams.get('jobId');}var handleClickOpen=function handleClickOpen(id){setOpen(true);setDeleteItem(id);};var handleClose=function handleClose(){setOpen(false);setDeleteItem(null);};var handleYes=function handleYes(){removeMilestoneByIndex(deleteItem);setOpen(false);setDeleteItem(null);};useEffect(function(){if(!(localMilestones===null||localMilestones===void 0?void 0:localMilestones.length)!==(milestones===null||milestones===void 0?void 0:milestones.length)){var filter_milestones=milestones.filter(function(item){return Object.keys(item).length&&item;});setLocalMilestones(filter_milestones);// set milestoner here!\nupdateMileStoneIndex(null);updateMileStoneTimings(null);}},[milestones,removeMilestoneByIndex]);useEffect(function(){console.log({localMilestones:localMilestones},'---->');},[localMilestones]);var reorder=function reorder(list,startIndex,endIndex){var result=Array.from(list);var _result$splice=result.splice(startIndex,1),_result$splice2=_slicedToArray(_result$splice,1),removed=_result$splice2[0];result.splice(endIndex,0,removed);return result;};var checkIfDatesValid=function checkIfDatesValid(){console.log({data:data});var start_selection=moment(data===null||data===void 0?void 0:data.from_date,'YYYY-MM-DD').format('MM-DD-YYYY');var end_selection=null;var urlParams=null;if(location.search){urlParams=new URLSearchParams(location.search);}if(moment(data===null||data===void 0?void 0:data.to_date,'YYYY-MM-DD').isValid()){if(!moment(data===null||data===void 0?void 0:data.to_date,'YYYY-MM-DD').isSame(moment(data===null||data===void 0?void 0:data.from_date,'YYYY-MM-DD'))){end_selection=moment(data===null||data===void 0?void 0:data.to_date,'YYYY-MM-DD').format('MM-DD-YYYY');}}var item_find=false;var filteredItem=localMilestones.filter(function(item){if(item.hasOwnProperty('from_date')){var _item$from_date;if(!(item===null||item===void 0?void 0:(_item$from_date=item.from_date)===null||_item$from_date===void 0?void 0:_item$from_date.length)||(item===null||item===void 0?void 0:item.from_date)!==\"Invalid date\"){return item;}}});var not_lie_between=false;if(filteredItem===null||filteredItem===void 0?void 0:filteredItem.length){filteredItem.forEach(function(item_date){var _urlParams;var start=moment(item_date.from_date,'MM-DD-YYYY').isValid()?item_date.from_date:null;var end=moment(item_date.to_date,'MM-DD-YYYY').isValid()?item_date.to_date:null;if(start&&end){if(start_selection&&end_selection){// if (moment(start_selection, 'MM-DD-YYYY').isAfter(moment(start, 'MM-DD-YYYY')) || moment(end_selection, 'MM-DD-YYYY').isBefore(moment(end, 'MM-DD-YYYY'))) {\nif(moment(start_selection,'MM-DD-YYYY').isAfter(moment(start,'MM-DD-YYYY'))){item_find=true;}}if(start_selection&&!end_selection){if(moment(start_selection,'MM-DD-YYYY').isAfter(moment(start,'MM-DD-YYYY'))){item_find=true;// not_lie_between = true;\n}}}if(urlParams&&((_urlParams=urlParams)===null||_urlParams===void 0?void 0:_urlParams.get('jobId'))){if(start_selection&&end_selection&&!end){if(moment(start,'MM-DD-YYYY').isBefore(moment(start_selection,'MM-DD-YYYY'))&&moment(end_selection,'MM-DD-YYYY').isAfter(moment(start,'MM-DD-YYYY'))){item_find=true;}}}else{if(start_selection&&end_selection&&!end){// if (moment(start, 'MM-DD-YYYY').isSameOrAfter(moment(start_selection, 'MM-DD-YYYY')) && moment(start, 'MM-DD-YYYY').isSameOrBefore(moment(end_selection, 'MM-DD-YYYY'))) {\nif(moment(start,'MM-DD-YYYY').isSameOrAfter(moment(start_selection,'MM-DD-YYYY'))){item_find=false;}else{item_find=true;}}}});}if(item_find){// if (not_lie_between) {\n//     setShowToast(true, 'Milestones dates should be lie between the job details');\n// } else {\nsetShowToast(true,'Please check the milestone dates');// }\nreturn item_find;}return item_find;};var checkIfValidDates=function checkIfValidDates(item){var isfilter=localMilestones.filter(function(item_){if(item_.hasOwnProperty('from_date')){var _item_$from_date;if((item_===null||item_===void 0?void 0:item_.from_date)!==\"Invalid date\"||!(item_===null||item_===void 0?void 0:(_item_$from_date=item_.from_date)===null||_item_$from_date===void 0?void 0:_item_$from_date.length)){return item_;}}});if(!(isfilter===null||isfilter===void 0?void 0:isfilter.length)){return true;}else{var newarr=isfilter.slice().sort(function(a,b){return moment(a.from_date,'MM-DD-YYYY').diff(moment(b.from_date,'MM-DD-YYYY'));});var filteredItem=item.filter(function(item_reorder){if(item_reorder.hasOwnProperty('from_date')){var _item_reorder$from_da;if((item_reorder===null||item_reorder===void 0?void 0:item_reorder.from_date)!==\"Invalid date\"||!(item_reorder===null||item_reorder===void 0?void 0:(_item_reorder$from_da=item_reorder.from_date)===null||_item_reorder$from_da===void 0?void 0:_item_reorder$from_da.length)){return item_reorder;}}});setSortedItems(newarr);console.log({newarr:newarr,filteredItem:filteredItem});return JSON.stringify(newarr)===JSON.stringify(filteredItem);}};var onDragEnd=function onDragEnd(result){var source=result.source,destination=result.destination;// dropped outside the list\nif(!destination){return;}// if (source.droppableId === destination.droppableId) {\nvar reOrderedMilestones=reorder(localMilestones,source.index,destination.index);console.log({reOrderedMilestones:reOrderedMilestones});setLocalMilestones(reOrderedMilestones);handleCombineMileStones(reOrderedMilestones);checkIfDatesValid();checkIfValidDates(reOrderedMilestones);};var checkOnClick=function checkOnClick(e,index){var edit_item_clone=editItem;edit_item_clone[index]=e.target.checked;setEditItems(function(prev){return _objectSpread(_objectSpread({},prev),edit_item_clone);});};var format='MM-DD-YYYY';return/*#__PURE__*/_jsx(\"div\",{className:\"app_wrapper\",children:/*#__PURE__*/_jsx(\"div\",{className:\"section_wrapper\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"custom_container\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Dialog,{open:open,onClose:handleClose,\"aria-labelledby\":\"alert-dialog-title\",\"aria-describedby\":\"alert-dialog-description\",children:[/*#__PURE__*/_jsx(DialogTitle,{id:\"alert-dialog-title\",children:\"Are you sure you want to delete the milestone ?\"}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:handleYes,color:\"primary\",autoFocus:true,children:'Yes'}),/*#__PURE__*/_jsx(Button,{onClick:handleClose,color:\"primary\",children:'No'})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"form_field\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex_row f_reverse\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex_col_sm_7\",children:[(editDetailPage===null||editDetailPage===void 0?void 0:editDetailPage.currentScreen)?/*#__PURE__*/_jsxs(\"div\",{className:\"relate\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"back\",onClick:function onClick(){handleStepForward(14);}}),/*#__PURE__*/_jsx(\"span\",{className:\"title\",children:\"Job milestones\"})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"relate\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"back\",onClick:handleStepBack}),/*#__PURE__*/_jsx(\"span\",{className:\"title\",children:\"Job milestones\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"commn_para\",children:'Use milestones to itemise scope of works. You’ll be notified when each milestone has been completed.'})]}),(localMilestones===null||localMilestones===void 0?void 0:localMilestones.length)?/*#__PURE__*/_jsx(\"div\",{onClick:function onClick(){var checkIfItem=checkIfDatesValid();if(!checkIfItem){var check=checkIfValidDates(localMilestones);if(check){handleCombineMileStones(localMilestones);handleStepForward(10);}else{setShowToast(true,\"Please arrange milestone date wise\");}}},className:\"flex_col_sm_5 text-right\",children:/*#__PURE__*/_jsx(\"span\",{className:\"link\",children:\"Save as template\"})}):null]})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex_row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex_col_sm_5\",children:[/*#__PURE__*/_jsx(DragDropContext,{onDragEnd:onDragEnd,children:/*#__PURE__*/_jsx(Droppable,{droppableId:\"milestones\",children:function children(provided,snapshot){return/*#__PURE__*/_jsxs(\"ul\",{ref:provided.innerRef,className:\"milestones\".concat(snapshot.isDraggingOver?' dragging-over':''),children:[(localMilestones===null||localMilestones===void 0?void 0:localMilestones.length)>0&&localMilestones.map(function(_ref2,index){var milestone_name=_ref2.milestone_name,isPhotoevidence=_ref2.isPhotoevidence,recommended_hours=_ref2.recommended_hours,from_date=_ref2.from_date,to_date=_ref2.to_date;return/*#__PURE__*/_jsx(Draggable,{draggableId:\"\".concat(milestone_name,\"-\").concat(index),index:index,children:function children(provided,snapshot){return/*#__PURE__*/_jsxs(\"li\",_objectSpread(_objectSpread(_objectSpread({ref:provided.innerRef},provided.draggableProps),provided.dragHandleProps),{},{style:_objectSpread({},provided.draggableProps.style),children:[editItem[index]?/*#__PURE__*/_jsxs(\"div\",{className:\"edit_delete\",children:[/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(e){e.stopPropagation();handleStepForward(15);updateMileStoneIndex(index);},className:\"edit\"}),/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(e){e.preventDefault();handleClickOpen(index);// removeMilestoneByIndex(index);\n// setEditItems({}); // too old comment\n},className:\"delete\"})]}):'',/*#__PURE__*/_jsxs(\"div\",{className:\"checkbox_wrap agree_check\",children:[/*#__PURE__*/_jsx(\"input\",{checked:editItem[index],onChange:function onChange(e){checkOnClick(e,index);},className:\"filter-type filled-in\",type:\"checkbox\",id:\"milestone\".concat(index)}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"milestone\".concat(index),children:\"\".concat(index+1,\". \").concat(milestone_name)}),/*#__PURE__*/_jsxs(\"div\",{className:\"info\",children:[isPhotoevidence?/*#__PURE__*/_jsx(\"span\",{children:'Photo evidence required'}):/*#__PURE__*/_jsx(\"span\",{}),/*#__PURE__*/_jsx(\"span\",{children:renderTimeWithFormat(from_date,to_date,format)}),recommended_hours&&/*#__PURE__*/_jsxs(\"span\",{children:[recommended_hours,' hours']})]})]})]}),index);}},\"\".concat(index,\"-\").concat(milestone_name));}),provided.placeholder,(localMilestones===null||localMilestones===void 0?void 0:localMilestones.length)===0&&/*#__PURE__*/_jsx(\"figure\",{className:\"placeholder_img\",children:/*#__PURE__*/_jsx(\"img\",{src:milestonesPlaceholder,alt:\"milestones-placeholder\"})})]});}})}),!(localMilestones===null||localMilestones===void 0?void 0:localMilestones.length)?/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"form_field\",children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){handleStepForward(9);},className:\"fill_btn fill_grey_btn full_btn btn-effect\",children:'Use template'})}),/*#__PURE__*/_jsx(\"div\",{className:\"form_field\",children:/*#__PURE__*/_jsx(\"button\",{className:\"fill_btn full_btn btn-effect\",onClick:function onClick(){return handleStepComplete({});},children:'+ Add milestone'})})]}):/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"form_field\",children:/*#__PURE__*/_jsx(\"button\",{className:\"fill_btn full_btn btn-effect\",onClick:function onClick(){if((milestones===null||milestones===void 0?void 0:milestones.length)===1){newMileStoneScreen(1);}else{var item=milestones[(milestones===null||milestones===void 0?void 0:milestones.length)-1];if(Object.keys(item).length){var _item$milestone_name,_item$recommended_hou,_item$date_from;if(!(item===null||item===void 0?void 0:(_item$milestone_name=item.milestone_name)===null||_item$milestone_name===void 0?void 0:_item$milestone_name.length)&&!(item===null||item===void 0?void 0:(_item$recommended_hou=item.recommended_hours)===null||_item$recommended_hou===void 0?void 0:_item$recommended_hou.length)&&!(item===null||item===void 0?void 0:(_item$date_from=item.date_from)===null||_item$date_from===void 0?void 0:_item$date_from.length)){console.log('Already have!');}else{newMileStoneScreen(milestones===null||milestones===void 0?void 0:milestones.length);}}}handleStepComplete({});},children:'+ Add milestone'})}),/*#__PURE__*/_jsx(\"div\",{className:\"form_field\",children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){var checkIfItem=checkIfDatesValid();console.log({checkIfItem:checkIfItem});if(!checkIfItem){var check=checkIfValidDates(localMilestones);console.log({check:check});if(check){handleCombineMileStones(localMilestones);if(editDetailPage===null||editDetailPage===void 0?void 0:editDetailPage.currentScreen){handleStepForward(14);}else{handleStepForward(13);}}else{setShowToast(true,\"Please arrange milestone date wise\");}}},className:\"fill_btn fill_grey_btn full_btn btn-effect\",children:'Continue'})})]})]})})]})})});};export default JobMilestones;","map":{"version":3,"sources":["/home/appinventiv/Documents/Project/tickt/web/src/pages/postJob/components/jobMilestones.tsx"],"names":["React","useEffect","useState","DragDropContext","Droppable","Draggable","moment","setShowToast","milestonesPlaceholder","Button","Dialog","DialogActions","DialogTitle","useLocation","renderTimeWithFormat","JobMilestones","data","stepCompleted","newMileStoneScreen","editDetailPage","editMileStone","editMilestoneTiming","handleStepJustUpdate","handleCombineMileStones","removeMilestoneByIndex","handleStepForward","updateMileStoneIndex","updateMileStoneTimings","milestones","handleStepComplete","handleStepBack","localMilestones","setLocalMilestones","editItem","setEditItems","open","setOpen","deleteItem","setDeleteItem","sortedItems","setSortedItems","location","jobId","search","urlParams","URLSearchParams","get","handleClickOpen","id","handleClose","handleYes","length","filter_milestones","filter","item","Object","keys","console","log","reorder","list","startIndex","endIndex","result","Array","from","splice","removed","checkIfDatesValid","start_selection","from_date","format","end_selection","to_date","isValid","isSame","item_find","filteredItem","hasOwnProperty","not_lie_between","forEach","item_date","start","end","isAfter","isBefore","isSameOrAfter","checkIfValidDates","isfilter","item_","newarr","slice","sort","a","b","diff","item_reorder","JSON","stringify","onDragEnd","source","destination","reOrderedMilestones","index","checkOnClick","e","edit_item_clone","target","checked","prev","currentScreen","checkIfItem","check","provided","snapshot","innerRef","isDraggingOver","map","milestone_name","isPhotoevidence","recommended_hours","draggableProps","dragHandleProps","style","stopPropagation","preventDefault","placeholder","date_from"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\n// @ts-ignore\nimport { DragDropContext, Droppable, Draggable, DropResult } from 'react-beautiful-dnd';\nimport moment from 'moment';\nimport { setShowToast } from '../../../redux/common/actions';\n\nimport milestonesPlaceholder from '../../../assets/images/Job milestones-preview.png';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport {  useLocation } from \"react-router-dom\";\n\nimport { renderTimeWithFormat } from '../../../utils/common';\n\n// please arrange milestone date wise.\n// milestone start date should be doffent from another can not be.\ninterface Proptypes {\n    data: any;\n    milestones: any;\n    editMileStone: any;\n    editDetailPage: any;\n    editMilestoneTiming: any;\n    stepCompleted: Boolean;\n    newMileStoneScreen: (data: any) => void;\n    handleStepComplete: (data: any) => void;\n    handleStepJustUpdate: (data: any, goto?: any) => void;\n    handleStepForward: (data: any, index?: number) => void;\n    handleStepBack: () => void;\n    updateMileStoneIndex: (data: any) => void;\n    handleCombineMileStones: (data: any) => void;\n    updateMileStoneTimings: (data: any) => void;\n    removeMilestoneByIndex: (data: any) => void;\n}\n\nconst JobMilestones = ({ data, stepCompleted, newMileStoneScreen, editDetailPage, editMileStone, editMilestoneTiming, handleStepJustUpdate, handleCombineMileStones, removeMilestoneByIndex, handleStepForward, updateMileStoneIndex, updateMileStoneTimings, milestones, handleStepComplete, handleStepBack }: Proptypes) => {\n    const [localMilestones, setLocalMilestones] = useState<Array<any>>([]);\n    const [editItem, setEditItems] = useState<{ [index: string]: any }>({});\n    const [open, setOpen] = React.useState(false);\n    const [deleteItem, setDeleteItem] = React.useState(null);\n    const [sortedItems, setSortedItems] = React.useState([]);\n\n    let location = useLocation();\n    let jobId: any = null;\n\n    if (location.search) {\n        let urlParams = new URLSearchParams(location.search);\n        jobId = urlParams.get('jobId');\n    }\n\n    const handleClickOpen = (id: any) => {\n        setOpen(true)\n        setDeleteItem(id);\n    };\n    const handleClose = () => {\n        setOpen(false)\n        setDeleteItem(null);\n    };\n\n    const handleYes = () => {\n        removeMilestoneByIndex(deleteItem);\n        setOpen(false);\n        setDeleteItem(null);\n    }\n\n    useEffect(() => {\n        if (!localMilestones?.length !== milestones?.length) {\n            let filter_milestones = milestones.filter((item: any) => Object.keys(item).length && item);\n            setLocalMilestones(filter_milestones); // set milestoner here!\n            updateMileStoneIndex(null);\n            updateMileStoneTimings(null);\n        }\n    }, [milestones, removeMilestoneByIndex]);\n\n    useEffect(() => {\n        console.log({ localMilestones }, '---->')\n    }, [localMilestones])\n\n    const reorder = (list: Array<any>, startIndex: number, endIndex: number) => {\n        const result = Array.from(list);\n        const [removed] = result.splice(startIndex, 1);\n        result.splice(endIndex, 0, removed);\n\n        return result;\n    };\n\n    const checkIfDatesValid = () => {\n        console.log({ data })\n        let start_selection: any = moment(data?.from_date, 'YYYY-MM-DD').format('MM-DD-YYYY');\n        let end_selection: any = null;\n        let urlParams: any = null;\n        if (location.search) {\n            urlParams = new URLSearchParams(location.search);\n        }\n\n        if (moment(data?.to_date, 'YYYY-MM-DD').isValid()) {\n            if (!moment(data?.to_date, 'YYYY-MM-DD').isSame(moment(data?.from_date, 'YYYY-MM-DD'))) {\n                end_selection = moment(data?.to_date, 'YYYY-MM-DD').format('MM-DD-YYYY');\n            }\n        }\n\n        let item_find: any = false;\n        let filteredItem = localMilestones.filter((item: any) => {\n            if (item.hasOwnProperty('from_date')) {\n                if (!item?.from_date?.length || item?.from_date !== \"Invalid date\") {\n                    return item;\n                }\n            }\n        });\n\n        let not_lie_between = false;\n        if (filteredItem?.length) {\n            filteredItem.forEach((item_date: any) => {\n                let start: any = moment(item_date.from_date, 'MM-DD-YYYY').isValid() ? item_date.from_date : null;\n                let end: any = moment(item_date.to_date, 'MM-DD-YYYY').isValid() ? item_date.to_date : null;\n\n                if (start && end) {\n                    if (start_selection && end_selection) {\n                        // if (moment(start_selection, 'MM-DD-YYYY').isAfter(moment(start, 'MM-DD-YYYY')) || moment(end_selection, 'MM-DD-YYYY').isBefore(moment(end, 'MM-DD-YYYY'))) {\n                        if (moment(start_selection, 'MM-DD-YYYY').isAfter(moment(start, 'MM-DD-YYYY'))) {\n                            item_find = true\n                        }\n                    }\n\n                    if (start_selection && !end_selection) {\n                        if (\n                            moment(start_selection, 'MM-DD-YYYY').isAfter(moment(start, 'MM-DD-YYYY'))\n                        ) {\n                            item_find = true;\n                            // not_lie_between = true;\n                        }\n                    }\n                }\n\n                if (urlParams && urlParams?.get('jobId')) {\n                    if (start_selection && end_selection && !end) {\n                        if (moment(start, 'MM-DD-YYYY').isBefore(moment(start_selection, 'MM-DD-YYYY')) && moment(end_selection, 'MM-DD-YYYY').isAfter(moment(start, 'MM-DD-YYYY'))) {\n                            item_find = true;\n                        }\n                    }\n                } else {\n                    if (start_selection && end_selection && !end) {\n                        // if (moment(start, 'MM-DD-YYYY').isSameOrAfter(moment(start_selection, 'MM-DD-YYYY')) && moment(start, 'MM-DD-YYYY').isSameOrBefore(moment(end_selection, 'MM-DD-YYYY'))) {\n                        if (moment(start, 'MM-DD-YYYY').isSameOrAfter(moment(start_selection, 'MM-DD-YYYY'))) {\n                            item_find = false;\n                        } else {\n                            item_find = true\n                        }\n                    }\n                }\n            });\n        }\n\n        if (item_find) {\n            // if (not_lie_between) {\n            //     setShowToast(true, 'Milestones dates should be lie between the job details');\n            // } else {\n                setShowToast(true, 'Please check the milestone dates');\n            // }\n            return item_find;\n        }\n\n        return item_find;\n    }\n\n    const checkIfValidDates = (item: any) => {\n        let isfilter = localMilestones.filter((item_: any) => {\n            if (item_.hasOwnProperty('from_date')) {\n                if (item_?.from_date !== \"Invalid date\" || !item_?.from_date?.length) {\n                    return item_;\n                }\n            }\n        });\n        if (!isfilter?.length) {\n            return true;\n        } else {\n            const newarr: any = isfilter.slice().sort((a, b) => {\n                return moment(a.from_date, 'MM-DD-YYYY').diff(moment(b.from_date, 'MM-DD-YYYY'));\n            });\n            let filteredItem: any = item.filter((item_reorder: any) => {\n                if (item_reorder.hasOwnProperty('from_date')) {\n                    if (item_reorder?.from_date !== \"Invalid date\" || !item_reorder?.from_date?.length) {\n                        return item_reorder;\n                    }\n                }\n            });\n            setSortedItems(newarr);\n            console.log({\n                newarr,\n                filteredItem\n            })\n            return JSON.stringify(newarr) === JSON.stringify(filteredItem);\n        }\n    }\n\n    const onDragEnd = (result: DropResult) => {\n        const { source, destination } = result;\n        // dropped outside the list\n        if (!destination) {\n            return;\n        }\n\n        // if (source.droppableId === destination.droppableId) {\n        const reOrderedMilestones = reorder(\n            localMilestones,\n            source.index,\n            destination.index\n        );\n        console.log({\n            reOrderedMilestones\n        })\n        setLocalMilestones(reOrderedMilestones);\n        handleCombineMileStones(reOrderedMilestones);\n        checkIfDatesValid();\n        checkIfValidDates(reOrderedMilestones);\n    };\n\n    const checkOnClick = (e: any, index: any) => {\n        let edit_item_clone: any = editItem;\n        edit_item_clone[index] = e.target.checked;\n        setEditItems((prev) => ({ ...prev, ...edit_item_clone }));\n    }\n\n    const format = 'MM-DD-YYYY';\n    return (\n        <div className=\"app_wrapper\">\n            <div className=\"section_wrapper\">\n                <div className=\"custom_container\">\n                    <div>\n                        <Dialog\n                            open={open}\n                            onClose={handleClose}\n                            aria-labelledby=\"alert-dialog-title\"\n                            aria-describedby=\"alert-dialog-description\"\n                        >\n                            <DialogTitle id=\"alert-dialog-title\">\n                                {\"Are you sure you want to delete the milestone ?\"}\n                            </DialogTitle>\n                            <DialogActions>\n                                <Button onClick={handleYes} color=\"primary\" autoFocus>\n                                    {'Yes'}\n                                </Button>\n                                <Button onClick={handleClose} color=\"primary\">\n                                    {'No'}\n                                </Button>\n                            </DialogActions>\n                        </Dialog>\n                    </div>\n\n\n                    <div className=\"form_field\">\n                        <div className=\"flex_row f_reverse\">\n                            <div className=\"flex_col_sm_7\">\n                                {editDetailPage?.currentScreen ? (\n                                    <div className=\"relate\">\n                                        <button className=\"back\" onClick={() => { handleStepForward(14) }}></button>\n                                        <span className=\"title\">Job milestones</span>\n                                    </div>\n                                ) : (\n                                    <div className=\"relate\">\n                                        <button className=\"back\" onClick={handleStepBack}></button>\n                                        <span className=\"title\">Job milestones</span>\n                                    </div>\n                                )}\n                                <p className=\"commn_para\">\n                                    {'Use milestones to itemise scope of works. You’ll be notified when each milestone has been completed.'}\n                                </p>\n                            </div>\n                            {localMilestones?.length ? (\n                                <div\n                                    onClick={() => {\n                                        let checkIfItem: boolean = checkIfDatesValid();\n                                        if (!checkIfItem) {\n                                            let check: boolean = checkIfValidDates(localMilestones);\n                                            if (check) {\n                                                handleCombineMileStones(localMilestones);\n                                                handleStepForward(10)\n                                            } else {\n                                                setShowToast(true, \"Please arrange milestone date wise\")\n                                            }\n                                        }\n                                    }}\n                                    className=\"flex_col_sm_5 text-right\">\n                                    <span className=\"link\">Save as template</span>\n                                </div>\n                            ) : null}\n                        </div>\n                    </div>\n                    <div className=\"flex_row\">\n                        <div className=\"flex_col_sm_5\">\n                            <DragDropContext onDragEnd={onDragEnd}>\n                                <Droppable droppableId=\"milestones\">\n                                    {(provided, snapshot) => (\n                                        <ul ref={provided.innerRef}\n                                            className={`milestones${snapshot.isDraggingOver ? ' dragging-over' : ''}`}>\n                                            {localMilestones?.length > 0 &&\n                                                localMilestones.map(({\n                                                    milestone_name,\n                                                    isPhotoevidence,\n                                                    recommended_hours,\n                                                    from_date,\n                                                    to_date\n                                                }: {\n                                                    milestone_name: string,\n                                                    isPhotoevidence: boolean,\n                                                    from_date: string,\n                                                    to_date: string,\n                                                    recommended_hours: any\n                                                }, index) => (\n                                                    <Draggable\n                                                        key={`${index}-${milestone_name}`}\n                                                        draggableId={`${milestone_name}-${index}`}\n                                                        index={index}\n                                                    >\n                                                        {(provided: any, snapshot: any) => (\n                                                            <li\n                                                                key={index}\n                                                                ref={provided.innerRef}\n                                                                {...provided.draggableProps}\n                                                                {...provided.dragHandleProps}\n                                                                style={{\n                                                                    ...provided.draggableProps.style,\n                                                                }}>\n                                                                {editItem[index] ? (\n                                                                    <div className=\"edit_delete\">\n                                                                        <span\n                                                                            onClick={(e) => {\n                                                                                e.stopPropagation();\n                                                                                handleStepForward(15);\n                                                                                updateMileStoneIndex(index);\n                                                                            }}\n                                                                            className=\"edit\">\n                                                                        </span>\n                                                                        <span\n                                                                            onClick={(e) => {\n                                                                                e.preventDefault();\n                                                                                handleClickOpen(index);\n                                                                                // removeMilestoneByIndex(index);\n\n                                                                                // setEditItems({}); // too old comment\n                                                                            }}\n                                                                            className=\"delete\"></span>\n                                                                    </div>\n                                                                ) : ''}\n                                                                <div className=\"checkbox_wrap agree_check\">\n                                                                    <input\n                                                                        checked={editItem[index]}\n                                                                        onChange={(e: any) => { checkOnClick(e, index) }}\n                                                                        className=\"filter-type filled-in\"\n                                                                        type=\"checkbox\"\n                                                                        id={`milestone${index}`} />\n                                                                    <label htmlFor={`milestone${index}`}>{`${index + 1}. ${milestone_name}`}</label>\n                                                                    <div className=\"info\">\n                                                                        {isPhotoevidence ?\n                                                                            <span>{'Photo evidence required'}</span>\n                                                                            : <span></span>}\n                                                                        <span>\n                                                                            {renderTimeWithFormat(\n                                                                                from_date,\n                                                                                to_date,\n                                                                                format\n                                                                            )}\n                                                                        </span>\n                                                                        {recommended_hours && <span>\n                                                                            {recommended_hours}\n                                                                            {' hours'}\n                                                                        </span>}\n                                                                    </div>\n                                                                </div>\n                                                            </li>\n                                                        )}\n                                                    </Draggable>\n                                                ))}\n                                            {provided.placeholder}\n                                            {localMilestones?.length === 0 && (\n                                                <figure className=\"placeholder_img\">\n                                                    <img src={milestonesPlaceholder} alt=\"milestones-placeholder\" />\n                                                </figure>\n                                            )}\n                                        </ul>\n                                    )}\n                                </Droppable>\n                            </DragDropContext>\n                            {!localMilestones?.length ? (\n                                <React.Fragment>\n                                    <div className=\"form_field\">\n                                        <button\n                                            onClick={() => {\n                                                handleStepForward(9)\n                                            }}\n                                            className=\"fill_btn fill_grey_btn full_btn btn-effect\">\n                                            {'Use template'}\n                                        </button>\n                                    </div>\n                                    <div className=\"form_field\">\n                                        <button className=\"fill_btn full_btn btn-effect\" onClick={() => handleStepComplete({})}>\n                                            {'+ Add milestone'}\n                                        </button>\n                                    </div>\n                                </React.Fragment>\n                            ) : (\n                                <React.Fragment>\n                                    <div className=\"form_field\">\n                                        <button className=\"fill_btn full_btn btn-effect\"\n                                            onClick={() => {\n                                                if (milestones?.length === 1) {\n                                                    newMileStoneScreen(1);\n                                                } else {\n                                                    let item = milestones[milestones?.length - 1];\n                                                    if (Object.keys(item).length) {\n                                                        if (\n                                                            !item?.milestone_name?.length &&\n                                                            !item?.recommended_hours?.length &&\n                                                            !item?.date_from?.length) {\n                                                            console.log('Already have!')\n                                                        } else {\n                                                            newMileStoneScreen(milestones?.length);\n                                                        }\n                                                    }\n                                                }\n                                                handleStepComplete({})\n                                            }}>\n                                            {'+ Add milestone'}\n                                        </button>\n                                    </div>\n                                    <div className=\"form_field\">\n                                        <button\n                                            onClick={() => {\n\n\n                                                let checkIfItem: boolean = checkIfDatesValid();\n                                                console.log({ checkIfItem })\n                                                if (!checkIfItem) {\n                                                    let check: boolean = checkIfValidDates(localMilestones);\n                                                    console.log({ check })\n                                                    if (check) {\n                                                        handleCombineMileStones(localMilestones);\n                                                        if (editDetailPage?.currentScreen) {\n                                                            handleStepForward(14)\n                                                        } else {\n                                                            handleStepForward(13)\n                                                        }\n                                                    } else {\n                                                        setShowToast(true, \"Please arrange milestone date wise\")\n                                                    }\n                                                }\n                                            }}\n                                            className=\"fill_btn fill_grey_btn full_btn btn-effect\">\n                                            {'Continue'}\n                                        </button>\n                                    </div>\n                                </React.Fragment>\n                            )}\n\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    )\n}\n\nexport default JobMilestones;\n"]},"metadata":{},"sourceType":"module"}