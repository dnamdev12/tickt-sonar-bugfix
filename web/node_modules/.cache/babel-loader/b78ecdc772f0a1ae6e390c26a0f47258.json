{"ast":null,"code":"import _regeneratorRuntime from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{verifyOtp,resendOtp}from'../../../redux/auth/actions';import Constants from'../../../utils/constants';import regex from'../../../utils/regex';import{setShowToast}from'../../../redux/common/actions';import OtpInput from\"react-otp-input\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PhoneNumber=function PhoneNumber(props){var _useState=useState({}),_useState2=_slicedToArray(_useState,2),errors=_useState2[0],setErrors=_useState2[1];var _useState3=useState(Constants.OTP_TIMER),_useState4=_slicedToArray(_useState3,2),counter=_useState4[0],setCounter=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),otp=_useState6[0],setOTP=_useState6[1];var changeHandler=function changeHandler(newOtp){setOTP(newOtp);};useEffect(function(){var timer=counter>0&&setInterval(function(){return setCounter(counter-1);},1000);return function(){return clearInterval(timer);};},[counter]);var validateForm=function validateForm(){var newErrors={};if(!otp){newErrors.otp=Constants.errorStrings.otpEmpty;}else{var otpRegex=new RegExp(regex.otp);if(!otpRegex.test(otp)){newErrors.otp=Constants.errorStrings.otpIncorrect;}}setErrors(newErrors);return!Object.keys(newErrors).length;};var onSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var _data,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();if(!validateForm()){_context.next=7;break;}_data={email:props.email,otp:otp};_context.next=5;return verifyOtp(_data);case 5:res=_context.sent;if(res.success){props.updateSteps(props.step+1,{email:props.email});}case 7:case\"end\":return _context.stop();}}},_callee);}));return function onSubmit(_x){return _ref.apply(this,arguments);};}();var resendHandler=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var data,response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:data={\"email\":props.email};_context2.next=3;return resendOtp(data);case 3:response=_context2.sent;if(response.success){setShowToast(true,'We have resent the verification code on your email. Please check your email');setCounter(Constants.OTP_TIMER);}case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function resendHandler(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"form_wrapper\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:onSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form_field\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"otp_input_wrapper\",children:/*#__PURE__*/_jsx(OtpInput,{className:\"sms-no-box\",inputStyle:{\"width\":\"48px\"},value:otp,onChange:changeHandler,numInputs:5,isInputNum:true})}),!!errors.otp&&/*#__PURE__*/_jsx(\"span\",{className:\"error_msg\",children:errors.otp})]}),/*#__PURE__*/_jsx(\"div\",{className:\"form_field\",children:/*#__PURE__*/_jsx(\"span\",{className:\"show_label\",children:'We have sent a verification code to your email. Please check the messages and enter the 5-digit code here.'})}),counter===0&&/*#__PURE__*/_jsxs(\"div\",{className:\"form_field text-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"show_label\",children:\"Don\\u2019t you receive any codes?\"}),/*#__PURE__*/_jsx(\"a\",{href:\"#\",className:\"link\",onClick:resendHandler,children:\"Re-send code\"})]}),counter>0&&/*#__PURE__*/_jsx(\"div\",{className:\"form_field text-center\",children:/*#__PURE__*/_jsx(\"span\",{className:\"show_label timer\",children:counter>59?\"01 : 00\":\"00 : \".concat(counter)})}),/*#__PURE__*/_jsx(\"div\",{className:\"form_field\",children:/*#__PURE__*/_jsx(\"button\",{className:\"fill_btn btn-effect\",children:\"Next\"})})]})});};export default PhoneNumber;","map":{"version":3,"sources":["/home/appinventiv/Documents/Project/tickt/web/src/pages/forgetPassword/components/EmailVerification.tsx"],"names":["React","useState","useEffect","verifyOtp","resendOtp","Constants","regex","setShowToast","OtpInput","PhoneNumber","props","errors","setErrors","OTP_TIMER","counter","setCounter","otp","setOTP","changeHandler","newOtp","timer","setInterval","clearInterval","validateForm","newErrors","errorStrings","otpEmpty","otpRegex","RegExp","test","otpIncorrect","Object","keys","length","onSubmit","e","preventDefault","data","email","res","success","updateSteps","step","resendHandler","response"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { verifyOtp, resendOtp } from '../../../redux/auth/actions';\nimport Constants from '../../../utils/constants';\nimport regex from '../../../utils/regex';\nimport { setShowToast } from '../../../redux/common/actions';\nimport OtpInput from \"react-otp-input\";\n\ninterface Propstype {\n    updateSteps: (num: number, data: any) => void\n    step: number\n    history?: any\n    email: any,\n}\n\nconst PhoneNumber = (props: Propstype) => {\n    const [errors, setErrors] = useState<any>({});\n    const [counter, setCounter] = useState(Constants.OTP_TIMER);\n    const [otp, setOTP] = useState('');\n\n    const changeHandler = (newOtp: any) => {\n        setOTP(newOtp)\n    }\n\n    useEffect(() => {\n        const timer: any = counter > 0 && setInterval(() => setCounter(counter - 1), 1000);\n        return () => clearInterval(timer);\n    }, [counter]);\n\n    const validateForm = () => {\n        const newErrors: any = {};\n        if (!otp) {\n            newErrors.otp = Constants.errorStrings.otpEmpty;\n        } else {\n            const otpRegex = new RegExp(regex.otp);\n            if (!otpRegex.test(otp)) {\n                newErrors.otp = Constants.errorStrings.otpIncorrect\n            }\n        }\n        setErrors(newErrors);\n        return !Object.keys(newErrors).length;\n    }\n\n    const onSubmit = async (e: any) => {\n        e.preventDefault();\n        if (validateForm()) {\n            const data = {\n                email: props.email,\n                otp: otp\n            }\n            const res: any = await verifyOtp(data)\n            if (res.success) {\n                props.updateSteps(props.step + 1, {\n                    email: props.email\n                })\n            }\n        }\n    }\n\n    const resendHandler = async () => {\n        let data = {\n            \"email\": props.email,\n        };\n        let response = await resendOtp(data);\n        if (response.success) {\n            setShowToast(true, 'We have resent the verification code on your email. Please check your email');\n            setCounter(Constants.OTP_TIMER);\n        }\n    }\n\n    return (\n        <div className=\"form_wrapper\">\n            <form onSubmit={onSubmit}>\n                <div className=\"form_field\">\n                    <div className=\"otp_input_wrapper\">\n                        <OtpInput\n                            className=\"sms-no-box\"\n                            inputStyle={{ \"width\": \"48px\" }}\n                            value={otp}\n                            onChange={changeHandler}\n                            numInputs={5}\n                            isInputNum\n                        />\n                    </div>\n                    {!!errors.otp && <span className=\"error_msg\">{errors.otp}</span>}\n                </div>\n\n                <div className=\"form_field\">\n                    <span className=\"show_label\">\n                        {'We have sent a verification code to your email. Please check the messages and enter the 5-digit code here.'}\n                        {/* We have sent a verification code to your email. Please check email and enter the 5-digit code here. */}\n                    </span>\n                </div>\n\n                {counter === 0 &&\n                    <div className=\"form_field text-center\">\n                        <span className=\"show_label\">Donâ€™t you receive any codes?</span>\n                        <a href=\"#\" className=\"link\" onClick={resendHandler}>Re-send code</a>\n                    </div>\n                }\n\n                {counter > 0 && <div className=\"form_field text-center\">\n                    <span className=\"show_label timer\">{counter > 59 ? `01 : 00` : `00 : ${counter}`}</span>\n                </div>}\n\n                <div className=\"form_field\">\n                    <button className=\"fill_btn btn-effect\">Next</button>\n                </div>\n            </form>\n\n        </div>\n    )\n}\n\nexport default PhoneNumber;\n\n"]},"metadata":{},"sourceType":"module"}