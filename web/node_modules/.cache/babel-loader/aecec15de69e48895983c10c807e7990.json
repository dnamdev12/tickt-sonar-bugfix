{"ast":null,"code":"import _regeneratorRuntime from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useEffect}from'react';import{verifyMobileOtp,resendMobileOtp}from'../../../redux/auth/actions';import Constants from'../../../utils/constants';import regex from'../../../utils/regex';import OtpInput from\"react-otp-input\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var VerifyPhoneNumber=function VerifyPhoneNumber(props){var _useState=useState({}),_useState2=_slicedToArray(_useState,2),errors=_useState2[0],setErrors=_useState2[1];var _useState3=useState(Constants.OTP_TIMER),_useState4=_slicedToArray(_useState3,2),counter=_useState4[0],setCounter=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),otp=_useState6[0],setOTP=_useState6[1];var changeHandler=function changeHandler(newOtp){setOTP(newOtp);};useEffect(function(){var timer=counter>0&&setInterval(function(){return setCounter(counter-1);},1000);return function(){return clearInterval(timer);};},[counter]);var validateForm=function validateForm(){var newErrors={};if(!otp){newErrors.otp=Constants.errorStrings.otpEmpty;}else{var otpRegex=new RegExp(regex.otp);if(!otpRegex.test(otp)){newErrors.otp=Constants.errorStrings.otpIncorrect;}}setErrors(newErrors);return!Object.keys(newErrors).length;};var onSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var data,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();if(!validateForm()){_context.next=7;break;}data={otp:otp,mobileNumber:props.mobileNumber};// const res: any = await verifyOtp(data)\n_context.next=5;return verifyMobileOtp(data);case 5:res=_context.sent;if(res.success){props.updateSteps(props.step+1);}case 7:case\"end\":return _context.stop();}}},_callee);}));return function onSubmit(_x){return _ref.apply(this,arguments);};}();var resendHandler=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var data,response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();data={\"mobileNumber\":props.mobileNumber};_context2.next=4;return resendMobileOtp(data);case 4:response=_context2.sent;if(response.success){// const res: any = await checkMobileNumber(props.mobileNumber)\nsetCounter(Constants.OTP_TIMER);}case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function resendHandler(_x2){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"form_wrapper\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:onSubmit,children:[/*#__PURE__*/_jsx(\"span\",{className:\"show_label\",children:\"Verification Code\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form_field\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"otp_input_wrapper\",children:/*#__PURE__*/_jsx(OtpInput,{className:\"sms-no-box\",inputStyle:{\"width\":\"48px\"},value:otp,onChange:changeHandler,numInputs:5,isInputNum:true//separator={<span>-</span>}\n})}),!!errors.otp&&/*#__PURE__*/_jsx(\"span\",{className:\"error_msg\",children:errors.otp})]}),/*#__PURE__*/_jsx(\"div\",{className:\"form_field\",children:/*#__PURE__*/_jsx(\"span\",{className:\"show_label\",children:\"We have sent a verification code to your phone. Please check SMS and enter the 5-digit code here.\"})}),counter===0&&/*#__PURE__*/_jsxs(\"div\",{className:\"form_field text-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"show_label\",children:\"Don\\u2019t you receive any codes?\"}),/*#__PURE__*/_jsx(\"a\",{href:\"#\",className:\"link\",onClick:resendHandler,children:\"Re-send code\"})]}),counter>0&&/*#__PURE__*/_jsx(\"div\",{className:\"form_field text-center\",children:/*#__PURE__*/_jsx(\"span\",{className:\"show_label timer\",children:counter>59?\"01 : 00\":\"00 : \".concat(counter)})}),/*#__PURE__*/_jsx(\"div\",{className:\"form_field\",children:/*#__PURE__*/_jsx(\"button\",{className:\"fill_btn btn-effect\",children:\"Next\"})})]})});};export default VerifyPhoneNumber;","map":{"version":3,"sources":["/home/appinventiv/Documents/Project/tickt/web/src/pages/signup/components/verifyPhoneNumber.tsx"],"names":["useState","useEffect","verifyMobileOtp","resendMobileOtp","Constants","regex","OtpInput","VerifyPhoneNumber","props","errors","setErrors","OTP_TIMER","counter","setCounter","otp","setOTP","changeHandler","newOtp","timer","setInterval","clearInterval","validateForm","newErrors","errorStrings","otpEmpty","otpRegex","RegExp","test","otpIncorrect","Object","keys","length","onSubmit","e","preventDefault","data","mobileNumber","res","success","updateSteps","step","resendHandler","response"],"mappings":"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","sourcesContent":["import { useState, useEffect } from 'react';\nimport { checkMobileNumber, verifyOtp, verifyMobileOtp , resendOtp, resendMobileOtp} from '../../../redux/auth/actions';\nimport Constants from '../../../utils/constants';\nimport regex from '../../../utils/regex';\nimport OtpInput from \"react-otp-input\";\n\ninterface Propstype {\n    updateSteps: (num: number) => void\n    step: number\n    history?: any\n    mobileNumber: string,\n    userType?: any\n}\n\nconst VerifyPhoneNumber = (props: Propstype) => {\n    const [errors, setErrors] = useState<any>({});\n    const [counter, setCounter] = useState(Constants.OTP_TIMER);\n    const [otp, setOTP] = useState('');\n\n    const changeHandler = (newOtp: any) => {\n        setOTP(newOtp)\n    }\n\n    useEffect(() => {\n        const timer: any = counter > 0 && setInterval(() => setCounter(counter - 1), 1000);\n        return () => clearInterval(timer);\n    }, [counter]);\n\n    const validateForm = () => {\n        const newErrors: any = {};\n        if (!otp) {\n            newErrors.otp = Constants.errorStrings.otpEmpty;\n        } else {\n            const otpRegex = new RegExp(regex.otp);\n            if (!otpRegex.test(otp)) {\n                newErrors.otp = Constants.errorStrings.otpIncorrect\n            }\n        }\n        setErrors(newErrors);\n        return !Object.keys(newErrors).length;\n    }\n\n    const onSubmit = async (e: any) => {\n        e.preventDefault();\n        if (validateForm()) {\n            const data = {\n                otp: otp,\n                mobileNumber: props.mobileNumber\n            }\n            // const res: any = await verifyOtp(data)\n            const res: any = await verifyMobileOtp(data);\n            if (res.success) {\n                props.updateSteps(props.step + 1)\n            }\n        }\n    }\n\n    const resendHandler = async (e: any) => {\n        e.preventDefault();\n        let data = {\n            \"mobileNumber\": props.mobileNumber\n        };\n        let response = await resendMobileOtp(data);\n        if (response.success) {\n        // const res: any = await checkMobileNumber(props.mobileNumber)\n            setCounter(Constants.OTP_TIMER)\n        }\n    }\n\n    return (\n        <div className=\"form_wrapper\">\n            <form onSubmit={onSubmit}>\n                <span className=\"show_label\">Verification Code</span>\n                {/* <div className=\"otp_input_wrapper\">\n                                <input type=\"number\" className=\"sms-no-box\" name=\"ssn-1\" maxLength={1} onChange={changeHandler} />\n                            </div> */}\n                <div className=\"form_field\">\n                    <div className=\"otp_input_wrapper\">\n                        <OtpInput\n                            className=\"sms-no-box\"\n                            inputStyle={{ \"width\": \"48px\" }}\n                            value={otp}\n                            onChange={changeHandler}\n                            numInputs={5}\n                            isInputNum\n                        //separator={<span>-</span>}\n                        />\n                    </div>\n                    {!!errors.otp && <span className=\"error_msg\">{errors.otp}</span>}\n                </div>\n                <div className=\"form_field\">\n                    <span className=\"show_label\">We have sent a verification code to your phone.\n                        Please check SMS and enter the 5-digit code here.</span>\n                </div>\n                {counter === 0 &&\n                 <div className=\"form_field text-center\">\n                    <span className=\"show_label\">Donâ€™t you receive any codes?</span>\n                    <a href=\"#\" className=\"link\" onClick={resendHandler}>Re-send code</a>\n                </div>\n                } \n                {counter > 0 && <div className=\"form_field text-center\">\n                    <span className=\"show_label timer\">{counter > 59 ? `01 : 00` : `00 : ${counter}`}</span>\n                </div>}\n                <div className=\"form_field\">\n                    <button className=\"fill_btn btn-effect\">Next</button>\n                </div>\n            </form>\n        </div>\n    )\n}\n\nexport default VerifyPhoneNumber\n\n"]},"metadata":{},"sourceType":"module"}