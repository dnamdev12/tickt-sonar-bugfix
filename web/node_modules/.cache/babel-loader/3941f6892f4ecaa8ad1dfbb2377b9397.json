{"ast":null,"code":"var _jsxFileName = \"/home/appinventiv/Documents/Project/tickt/web/src/pages/tradieEditProfile/components/personalInformation/changeEmailModal/components/verifyNewEmail.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport Constants from '../../../../../../utils/constants';\nimport regex from '../../../../../../utils/regex';\nimport { verifyEmailOtp, tradieChangeEmail } from \"../../../../../../redux/profile/actions\";\nimport OtpInput from \"react-otp-input\";\nimport cancel from \"../../../../../../assets/images/ic-cancel.png\";\nimport storageService from '../../../../../../utils/storageService';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst VerifyNewEmail = props => {\n  _s();\n\n  const [errors, setErrors] = useState({});\n  const [counter, setCounter] = useState(Constants.OTP_TIMER);\n  const [otp, setOTP] = useState('');\n\n  const changeHandler = newOtp => {\n    setOTP(newOtp);\n  };\n\n  useEffect(() => {\n    const timer = counter > 0 && setInterval(() => setCounter(counter - 1), 1000);\n    return () => clearInterval(timer);\n  }, [counter]);\n\n  const validateForm = () => {\n    const newErrors = {};\n\n    if (!otp) {\n      newErrors.otp = Constants.errorStrings.otpEmpty;\n    } else {\n      const otpregex = new RegExp(regex.otp);\n\n      if (!otpregex.test(otp)) {\n        newErrors.otp = Constants.errorStrings.otpIncorrect;\n      }\n    }\n\n    setErrors(newErrors);\n    return !Object.keys(newErrors).length;\n  };\n\n  const resendHandler = async e => {\n    e.preventDefault();\n    const data = {\n      currentEmail: props.currentEmail,\n      newEmail: props.newEmail,\n      password: props.currentPassword,\n      user_type: storageService.getItem('userType')\n    };\n    const res = await tradieChangeEmail(data);\n\n    if (res.success) {\n      setCounter(Constants.OTP_TIMER);\n    }\n  };\n\n  const onSubmit = async e => {\n    e.preventDefault();\n\n    if (validateForm()) {\n      const data = {\n        newEmail: props.newEmail,\n        otp: otp\n      };\n      const res = await verifyEmailOtp(data);\n\n      if (res.success) {\n        var _props$history;\n\n        (_props$history = props.history) === null || _props$history === void 0 ? void 0 : _props$history.push('/email-updated-successfully');\n      }\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"heading form_field\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relate\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"back\",\n          onClick: props.backButtonHandler\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"md_heading\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"sub_title\",\n            children: \"Verify your email\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"close_btn\",\n        onClick: props.closeModalHandler,\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: cancel,\n          alt: \"cancel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: onSubmit,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"inner_wrap\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form_wrapper\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"show_label\",\n            children: \"Verification Code\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form_field\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"otp_input_wrapper\",\n              children: /*#__PURE__*/_jsxDEV(OtpInput, {\n                className: \"sms-no-box\",\n                inputStyle: {\n                  \"width\": \"48px\"\n                },\n                value: otp,\n                onChange: changeHandler,\n                numInputs: 5,\n                isInputNum: true //separator={<span>-</span>}\n\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 98,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 97,\n              columnNumber: 29\n            }, this), !!errors.otp && /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"error_msg\",\n              children: errors.otp\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 108,\n              columnNumber: 46\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 96,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form_field\",\n            children: /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"show_label\",\n              children: \"We have sent a verification code to your new email. Please check email and enter the 5-digit code here.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 111,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 110,\n            columnNumber: 25\n          }, this), counter === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form_field f_spacebw\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"show_label\",\n              children: \"Don\\u2019t you receive any codes?\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 115,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n              href: \"#\",\n              className: \"link\",\n              onClick: resendHandler,\n              children: \"Re-send code\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 116,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 43\n          }, this), counter > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"show_label timer\",\n              children: counter > 59 ? `01 : 00` : `00 : ${counter}`\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 119,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 118,\n            columnNumber: 41\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bottom_btn custom_btn\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"fill_btn full_btn btn-effect\",\n          children: \"Next\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true);\n};\n\n_s(VerifyNewEmail, \"JxbVA7j/6U7TBfkAsELR3eMJ5Ak=\");\n\n_c = VerifyNewEmail;\nexport default VerifyNewEmail;\n\nvar _c;\n\n$RefreshReg$(_c, \"VerifyNewEmail\");","map":{"version":3,"sources":["/home/appinventiv/Documents/Project/tickt/web/src/pages/tradieEditProfile/components/personalInformation/changeEmailModal/components/verifyNewEmail.tsx"],"names":["React","useState","useEffect","Constants","regex","verifyEmailOtp","tradieChangeEmail","OtpInput","cancel","storageService","VerifyNewEmail","props","errors","setErrors","counter","setCounter","OTP_TIMER","otp","setOTP","changeHandler","newOtp","timer","setInterval","clearInterval","validateForm","newErrors","errorStrings","otpEmpty","otpregex","RegExp","test","otpIncorrect","Object","keys","length","resendHandler","e","preventDefault","data","currentEmail","newEmail","password","currentPassword","user_type","getItem","res","success","onSubmit","history","push","backButtonHandler","closeModalHandler"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport Constants from '../../../../../../utils/constants';\nimport regex from '../../../../../../utils/regex';\nimport {\n  verifyEmailOtp,\n  tradieChangeEmail,\n} from \"../../../../../../redux/profile/actions\";\nimport OtpInput from \"react-otp-input\";\n\nimport cancel from \"../../../../../../assets/images/ic-cancel.png\";\nimport storageService from '../../../../../../utils/storageService';\n\ninterface PropsTypes {\n    history: any,\n    currentEmail: string,\n    newEmail: string,\n    currentPassword: string,\n    updateSteps: (step: number, newData?: any) => void,\n    backButtonHandler: () => void,\n    closeModalHandler: () => void,\n}\n\nconst VerifyNewEmail = (props: PropsTypes) => {\n    const [errors, setErrors] = useState<any>({});\n    const [counter, setCounter] = useState(Constants.OTP_TIMER);\n    const [otp, setOTP] = useState('');\n\n    const changeHandler = (newOtp: any) => {\n        setOTP(newOtp);\n    }\n\n    useEffect(() => {\n        const timer: any = counter > 0 && setInterval(() => setCounter(counter - 1), 1000);\n        return () => clearInterval(timer);\n    }, [counter]);\n\n    const validateForm = () => {\n        const newErrors: any = {};\n        if (!otp) {\n            newErrors.otp = Constants.errorStrings.otpEmpty;\n        } else {\n            const otpregex = new RegExp(regex.otp);\n            if (!otpregex.test(otp)) {\n                newErrors.otp = Constants.errorStrings.otpIncorrect;\n            }\n        }\n        setErrors(newErrors);\n        return !Object.keys(newErrors).length;\n    }\n\n    const resendHandler = async (e: any) => {\n        e.preventDefault()\n        const data = {\n            currentEmail: props.currentEmail,\n            newEmail: props.newEmail,\n            password: props.currentPassword,\n            user_type: storageService.getItem('userType'),\n        }\n        const res = await tradieChangeEmail(data);\n        if (res.success) {\n            setCounter(Constants.OTP_TIMER);\n        }\n    }\n\n    const onSubmit = async (e: any) => {\n        e.preventDefault();\n        if (validateForm()) {\n            const data = {\n                newEmail: props.newEmail,\n                otp: otp\n            }\n            const res: any = await verifyEmailOtp(data);\n            if (res.success) {\n                props.history?.push('/email-updated-successfully');\n            }\n        }\n    }\n\n    return (\n        <>\n            <div className=\"heading form_field\">\n                <div className=\"relate\">\n                    <button className=\"back\" onClick={props.backButtonHandler}></button>\n                    <div className=\"md_heading\">\n                        <span className=\"sub_title\">Verify your email</span>\n                    </div>\n                </div>\n                <button className=\"close_btn\" onClick={props.closeModalHandler}>\n                    <img src={cancel} alt=\"cancel\" />\n                </button>\n            </div>\n            <form onSubmit={onSubmit}>\n                <div className=\"inner_wrap\">\n                    <div className=\"form_wrapper\">\n                        <span className=\"show_label\">Verification Code</span>\n                        <div className=\"form_field\">\n                            <div className=\"otp_input_wrapper\">\n                                <OtpInput\n                                    className=\"sms-no-box\"\n                                    inputStyle={{ \"width\": \"48px\" }}\n                                    value={otp}\n                                    onChange={changeHandler}\n                                    numInputs={5}\n                                    isInputNum\n                                //separator={<span>-</span>}\n                                />\n                            </div>\n                            {!!errors.otp && <span className=\"error_msg\">{errors.otp}</span>}\n                        </div>\n                        <div className=\"form_field\">\n                            <span className=\"show_label\">We have sent a verification code to your new email.\n                                Please check email and enter the 5-digit code here.</span>\n                        </div>\n                        {counter === 0 && <div className=\"form_field f_spacebw\">\n                            <span className=\"show_label\">Donâ€™t you receive any codes?</span>\n                            <a href=\"#\" className=\"link\" onClick={resendHandler}>Re-send code</a>\n                        </div>}\n                        {counter > 0 && <div>\n                            <span className=\"show_label timer\">{counter > 59 ? `01 : 00` : `00 : ${counter}`}</span>\n                        </div>}\n\n                    </div>\n                </div>\n                <div className=\"bottom_btn custom_btn\">\n                    <button className=\"fill_btn full_btn btn-effect\">Next</button>\n                </div>\n            </form>\n        </>\n    )\n}\n\nexport default VerifyNewEmail;\n"]},"metadata":{},"sourceType":"module"}